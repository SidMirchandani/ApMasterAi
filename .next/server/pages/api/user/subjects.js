"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/user/subjects";
exports.ids = ["pages/api/user/subjects"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@neondatabase/serverless":
/*!*******************************************!*\
  !*** external "@neondatabase/serverless" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("@neondatabase/serverless");;

/***/ }),

/***/ "drizzle-orm":
/*!******************************!*\
  !*** external "drizzle-orm" ***!
  \******************************/
/***/ ((module) => {

module.exports = import("drizzle-orm");;

/***/ }),

/***/ "drizzle-orm/neon-serverless":
/*!**********************************************!*\
  !*** external "drizzle-orm/neon-serverless" ***!
  \**********************************************/
/***/ ((module) => {

module.exports = import("drizzle-orm/neon-serverless");;

/***/ }),

/***/ "drizzle-orm/pg-core":
/*!**************************************!*\
  !*** external "drizzle-orm/pg-core" ***!
  \**************************************/
/***/ ((module) => {

module.exports = import("drizzle-orm/pg-core");;

/***/ }),

/***/ "drizzle-zod":
/*!******************************!*\
  !*** external "drizzle-zod" ***!
  \******************************/
/***/ ((module) => {

module.exports = import("drizzle-zod");;

/***/ }),

/***/ "ws":
/*!*********************!*\
  !*** external "ws" ***!
  \*********************/
/***/ ((module) => {

module.exports = import("ws");;

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/user/subjects.ts */ \"(api)/./pages/api/user/subjects.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/user/subjects\",\n        pathname: \"/api/user/subjects\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVzZXIlMkZzdWJqZWN0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGdXNlciUyRnN1YmplY3RzLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3lEO0FBQ3pEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx3REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsd0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLz8zNGQyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvdXNlci9zdWJqZWN0cy50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3VzZXIvc3ViamVjdHNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS91c2VyL3N1YmplY3RzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/user/subjects.ts":
/*!************************************!*\
  !*** ./pages/api/user/subjects.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _server_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../server/storage */ \"(api)/./server/storage.ts\");\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @shared/schema */ \"(api)/./shared/schema.ts\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"zod\");\n/* harmony import */ var _server_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../server/db */ \"(api)/./server/db.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_server_storage__WEBPACK_IMPORTED_MODULE_0__, _shared_schema__WEBPACK_IMPORTED_MODULE_1__, zod__WEBPACK_IMPORTED_MODULE_2__, _server_db__WEBPACK_IMPORTED_MODULE_3__]);\n([_server_storage__WEBPACK_IMPORTED_MODULE_0__, _shared_schema__WEBPACK_IMPORTED_MODULE_1__, zod__WEBPACK_IMPORTED_MODULE_2__, _server_db__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\nasync function getOrCreateUser(firebaseUid) {\n    try {\n        // Ensure database is healthy\n        const isHealthy = await _server_db__WEBPACK_IMPORTED_MODULE_3__.databaseManager.healthCheck();\n        if (!isHealthy) {\n            console.log(\"Database unhealthy, forcing reconnection...\");\n            await _server_db__WEBPACK_IMPORTED_MODULE_3__.databaseManager.forceReconnect();\n        }\n        // Try to find user by username (using firebase UID as username)\n        let user = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.getUserByUsername(firebaseUid);\n        if (!user) {\n            // Create new user with Firebase UID as username\n            user = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.createUser({\n                username: firebaseUid,\n                password: \"firebase_auth\" // Placeholder since we use Firebase\n            });\n            console.log(\"Created new user for Firebase UID:\", firebaseUid);\n        }\n        return user.id;\n    } catch (error) {\n        console.error(\"Error in getOrCreateUser:\", error);\n        throw error;\n    }\n}\nasync function handler(req, res) {\n    const { method } = req;\n    try {\n        const firebaseUid = req.headers[\"x-user-id\"];\n        console.log(`${method} /api/user/subjects - Firebase UID:`, firebaseUid);\n        if (!firebaseUid) {\n            console.log(\"No Firebase UID provided in headers\");\n            return res.status(401).json({\n                success: false,\n                message: \"Authentication required\"\n            });\n        }\n        const userId = await getOrCreateUser(firebaseUid);\n        switch(method){\n            case \"GET\":\n                try {\n                    const subjects = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.getUserSubjects(userId);\n                    console.log(\"Retrieved subjects:\", subjects.length);\n                    return res.json({\n                        success: true,\n                        data: subjects\n                    });\n                } catch (error) {\n                    console.error(\"Error getting subjects:\", error);\n                    return res.status(500).json({\n                        success: false,\n                        message: \"Failed to load subjects from database\"\n                    });\n                }\n            case \"POST\":\n                console.log(\"Request body:\", req.body);\n                try {\n                    // Check if user already has this subject\n                    const hasSubject = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.hasUserSubject(userId, req.body.subjectId);\n                    if (hasSubject) {\n                        return res.status(409).json({\n                            success: false,\n                            message: \"Subject already added to dashboard\"\n                        });\n                    }\n                    const validatedData = _shared_schema__WEBPACK_IMPORTED_MODULE_1__.insertUserSubjectSchema.parse({\n                        ...req.body,\n                        userId\n                    });\n                    const subject = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.addUserSubject(validatedData);\n                    return res.json({\n                        success: true,\n                        message: \"Subject added to dashboard!\",\n                        data: subject\n                    });\n                } catch (error) {\n                    console.error(\"Error in POST:\", error);\n                    if (error instanceof zod__WEBPACK_IMPORTED_MODULE_2__.z.ZodError) {\n                        return res.status(400).json({\n                            success: false,\n                            message: \"Invalid subject data\",\n                            errors: error.errors\n                        });\n                    }\n                    return res.status(500).json({\n                        success: false,\n                        message: \"Failed to add subject to database\"\n                    });\n                }\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\"\n                ]);\n                return res.status(405).json({\n                    success: false,\n                    message: `Method ${method} not allowed`\n                });\n        }\n    } catch (error) {\n        console.error(`Unhandled error in ${method} /api/user/subjects:`, error);\n        return res.status(500).json({\n            success: false,\n            message: \"Internal server error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0JBQy9CLE9BQU9wQixJQUFJRyxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDOzRCQUMxQkMsU0FBUzs0QkFDVEMsU0FBUzs0QkFDVGUsUUFBUXhCLE1BQU13QixNQUFNO3dCQUN0QjtvQkFDRjtvQkFDQSxPQUFPckIsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQzt3QkFDMUJDLFNBQVM7d0JBQ1RDLFNBQVM7b0JBQ1g7Z0JBQ0Y7WUFFRjtnQkFDRU4sSUFBSXNCLFNBQVMsQ0FBQyxTQUFTO29CQUFDO29CQUFPO2lCQUFPO2dCQUN0QyxPQUFPdEIsSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztvQkFDMUJDLFNBQVM7b0JBQ1RDLFNBQVMsQ0FBQyxPQUFPLEVBQUVMLE9BQU8sWUFBWSxDQUFDO2dCQUN6QztRQUNKO0lBQ0YsRUFBRSxPQUFPSixPQUFPO1FBQ2RULFFBQVFTLEtBQUssQ0FBQyxDQUFDLG1CQUFtQixFQUFFSSxPQUFPLG9CQUFvQixDQUFDLEVBQUVKO1FBQ2xFLE9BQU9HLElBQUlHLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDMUJDLFNBQVM7WUFDVEMsU0FBUztRQUNYO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Jlc3QtZXhwcmVzcy8uL3BhZ2VzL2FwaS91c2VyL3N1YmplY3RzLnRzP2YxYjIiXSwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IHsgc3RvcmFnZSB9IGZyb20gXCIuLi8uLi8uLi9zZXJ2ZXIvc3RvcmFnZVwiO1xuaW1wb3J0IHsgaW5zZXJ0VXNlclN1YmplY3RTY2hlbWEgfSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5pbXBvcnQgeyBkYXRhYmFzZU1hbmFnZXIgfSBmcm9tIFwiLi4vLi4vLi4vc2VydmVyL2RiXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldE9yQ3JlYXRlVXNlcihmaXJlYmFzZVVpZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgdHJ5IHtcbiAgICAvLyBFbnN1cmUgZGF0YWJhc2UgaXMgaGVhbHRoeVxuICAgIGNvbnN0IGlzSGVhbHRoeSA9IGF3YWl0IGRhdGFiYXNlTWFuYWdlci5oZWFsdGhDaGVjaygpO1xuICAgIGlmICghaXNIZWFsdGh5KSB7XG4gICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgdW5oZWFsdGh5LCBmb3JjaW5nIHJlY29ubmVjdGlvbi4uLicpO1xuICAgICAgYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmZvcmNlUmVjb25uZWN0KCk7XG4gICAgfVxuICAgIFxuICAgIC8vIFRyeSB0byBmaW5kIHVzZXIgYnkgdXNlcm5hbWUgKHVzaW5nIGZpcmViYXNlIFVJRCBhcyB1c2VybmFtZSlcbiAgICBsZXQgdXNlciA9IGF3YWl0IHN0b3JhZ2UuZ2V0VXNlckJ5VXNlcm5hbWUoZmlyZWJhc2VVaWQpO1xuICAgIFxuICAgIGlmICghdXNlcikge1xuICAgICAgLy8gQ3JlYXRlIG5ldyB1c2VyIHdpdGggRmlyZWJhc2UgVUlEIGFzIHVzZXJuYW1lXG4gICAgICB1c2VyID0gYXdhaXQgc3RvcmFnZS5jcmVhdGVVc2VyKHtcbiAgICAgICAgdXNlcm5hbWU6IGZpcmViYXNlVWlkLFxuICAgICAgICBwYXNzd29yZDogJ2ZpcmViYXNlX2F1dGgnIC8vIFBsYWNlaG9sZGVyIHNpbmNlIHdlIHVzZSBGaXJlYmFzZVxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZygnQ3JlYXRlZCBuZXcgdXNlciBmb3IgRmlyZWJhc2UgVUlEOicsIGZpcmViYXNlVWlkKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHVzZXIuaWQ7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0T3JDcmVhdGVVc2VyOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZVxuKSB7XG4gIGNvbnN0IHsgbWV0aG9kIH0gPSByZXE7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBmaXJlYmFzZVVpZCA9IHJlcS5oZWFkZXJzWyd4LXVzZXItaWQnXSBhcyBzdHJpbmc7XG4gICAgY29uc29sZS5sb2coYCR7bWV0aG9kfSAvYXBpL3VzZXIvc3ViamVjdHMgLSBGaXJlYmFzZSBVSUQ6YCwgZmlyZWJhc2VVaWQpO1xuICAgIFxuICAgIGlmICghZmlyZWJhc2VVaWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiTm8gRmlyZWJhc2UgVUlEIHByb3ZpZGVkIGluIGhlYWRlcnNcIik7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICBtZXNzYWdlOiBcIkF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkXCIgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB1c2VySWQgPSBhd2FpdCBnZXRPckNyZWF0ZVVzZXIoZmlyZWJhc2VVaWQpO1xuXG4gICAgc3dpdGNoIChtZXRob2QpIHtcbiAgICAgIGNhc2UgJ0dFVCc6XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgc3ViamVjdHMgPSBhd2FpdCBzdG9yYWdlLmdldFVzZXJTdWJqZWN0cyh1c2VySWQpO1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXRyaWV2ZWQgc3ViamVjdHM6Jywgc3ViamVjdHMubGVuZ3RoKTtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyBcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxuICAgICAgICAgICAgZGF0YTogc3ViamVjdHMgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBzdWJqZWN0czonLCBlcnJvcik7XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gbG9hZCBzdWJqZWN0cyBmcm9tIGRhdGFiYXNlXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICBjYXNlICdQT1NUJzpcbiAgICAgICAgY29uc29sZS5sb2coXCJSZXF1ZXN0IGJvZHk6XCIsIHJlcS5ib2R5KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIENoZWNrIGlmIHVzZXIgYWxyZWFkeSBoYXMgdGhpcyBzdWJqZWN0XG4gICAgICAgICAgY29uc3QgaGFzU3ViamVjdCA9IGF3YWl0IHN0b3JhZ2UuaGFzVXNlclN1YmplY3QodXNlcklkLCByZXEuYm9keS5zdWJqZWN0SWQpO1xuICAgICAgICAgIGlmIChoYXNTdWJqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDkpLmpzb24oeyBcbiAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICAgICAgICBtZXNzYWdlOiBcIlN1YmplY3QgYWxyZWFkeSBhZGRlZCB0byBkYXNoYm9hcmRcIiBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IHZhbGlkYXRlZERhdGEgPSBpbnNlcnRVc2VyU3ViamVjdFNjaGVtYS5wYXJzZSh7XG4gICAgICAgICAgICAuLi5yZXEuYm9keSxcbiAgICAgICAgICAgIHVzZXJJZFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3Qgc3ViamVjdCA9IGF3YWl0IHN0b3JhZ2UuYWRkVXNlclN1YmplY3QodmFsaWRhdGVkRGF0YSk7XG5cbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oeyBcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHRydWUsIFxuICAgICAgICAgICAgbWVzc2FnZTogXCJTdWJqZWN0IGFkZGVkIHRvIGRhc2hib2FyZCFcIixcbiAgICAgICAgICAgIGRhdGE6IHN1YmplY3QgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIFBPU1Q6XCIsIGVycm9yKTtcbiAgICAgICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiB6LlpvZEVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcbiAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgc3ViamVjdCBkYXRhXCIsXG4gICAgICAgICAgICAgIGVycm9yczogZXJyb3IuZXJyb3JzXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBhZGQgc3ViamVjdCB0byBkYXRhYmFzZVwiIFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydHRVQnLCAnUE9TVCddKTtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBtZXNzYWdlOiBgTWV0aG9kICR7bWV0aG9kfSBub3QgYWxsb3dlZGBcbiAgICAgICAgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYFVuaGFuZGxlZCBlcnJvciBpbiAke21ldGhvZH0gL2FwaS91c2VyL3N1YmplY3RzOmAsIGVycm9yKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiXG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJzdG9yYWdlIiwiaW5zZXJ0VXNlclN1YmplY3RTY2hlbWEiLCJ6IiwiZGF0YWJhc2VNYW5hZ2VyIiwiZ2V0T3JDcmVhdGVVc2VyIiwiZmlyZWJhc2VVaWQiLCJpc0hlYWx0aHkiLCJoZWFsdGhDaGVjayIsImNvbnNvbGUiLCJsb2ciLCJmb3JjZVJlY29ubmVjdCIsInVzZXIiLCJnZXRVc2VyQnlVc2VybmFtZSIsImNyZWF0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiaWQiLCJlcnJvciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJoZWFkZXJzIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwidXNlcklkIiwic3ViamVjdHMiLCJnZXRVc2VyU3ViamVjdHMiLCJsZW5ndGgiLCJkYXRhIiwiYm9keSIsImhhc1N1YmplY3QiLCJoYXNVc2VyU3ViamVjdCIsInN1YmplY3RJZCIsInZhbGlkYXRlZERhdGEiLCJwYXJzZSIsInN1YmplY3QiLCJhZGRVc2VyU3ViamVjdCIsIlpvZEVycm9yIiwiZXJyb3JzIiwic2V0SGVhZGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/user/subjects.ts\n");

/***/ }),

/***/ "(api)/./server/db-retry-handler.ts":
/*!************************************!*\
  !*** ./server/db-retry-handler.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseRetryHandler: () => (/* binding */ DatabaseRetryHandler),\n/* harmony export */   ensureDatabaseHealth: () => (/* binding */ ensureDatabaseHealth)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(api)/./server/db.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_db__WEBPACK_IMPORTED_MODULE_0__]);\n_db__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n// Database retry mechanism for enhanced reliability\nclass DatabaseRetryHandler {\n    static{\n        this.DEFAULT_MAX_RETRIES = 3;\n    }\n    static{\n        this.DEFAULT_BACKOFF_MS = 1000;\n    }\n    // Execute database operation with retry logic\n    static async withRetry(operation, maxRetries = this.DEFAULT_MAX_RETRIES, backoffMs = this.DEFAULT_BACKOFF_MS) {\n        let lastError = null;\n        for(let attempt = 1; attempt <= maxRetries + 1; attempt++){\n            try {\n                // Check database health before executing\n                const isHealthy = await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.healthCheck();\n                if (!isHealthy && attempt === 1) {\n                    console.warn(\"Database appears unhealthy, attempting reconnection\");\n                    await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.forceReconnect();\n                }\n                return await operation();\n            } catch (error) {\n                lastError = error instanceof Error ? error : new Error(String(error));\n                console.warn(`Database operation failed (attempt ${attempt}/${maxRetries + 1}):`, lastError.message);\n                // Don't retry on the last attempt\n                if (attempt > maxRetries) break;\n                // Check if this is a connection-related error\n                if (this.isConnectionError(lastError)) {\n                    console.log(\"Connection error detected, forcing reconnection\");\n                    try {\n                        await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.forceReconnect();\n                    } catch (reconnectError) {\n                        console.error(\"Reconnection failed:\", reconnectError);\n                    }\n                }\n                // Exponential backoff with jitter\n                const delay = backoffMs * Math.pow(2, attempt - 1) + Math.random() * 1000;\n                await new Promise((resolve)=>setTimeout(resolve, Math.min(delay, 30000)));\n            }\n        }\n        throw lastError || new Error(\"Database operation failed after retries\");\n    }\n    // Check if error is connection-related\n    static isConnectionError(error) {\n        const connectionErrorPatterns = [\n            /connection/i,\n            /network/i,\n            /timeout/i,\n            /ECONNRESET/i,\n            /ENOTFOUND/i,\n            /ETIMEDOUT/i,\n            /socket/i,\n            /pool/i\n        ];\n        return connectionErrorPatterns.some((pattern)=>pattern.test(error.message) || pattern.test(error.name));\n    }\n    // Execute transaction with retry logic\n    static async withTransaction(operation, maxRetries = 2 // Fewer retries for transactions\n    ) {\n        return this.withRetry(async ()=>{\n            const db = _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.getDatabase();\n            return await db.transaction(operation);\n        }, maxRetries);\n    }\n    // Health check with automatic recovery\n    static async healthCheckWithRecovery() {\n        try {\n            const isHealthy = await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.healthCheck();\n            if (!isHealthy) {\n                console.log(\"Database health check failed, attempting recovery\");\n                await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.forceReconnect();\n                // Check again after reconnection\n                return await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.healthCheck();\n            }\n            return true;\n        } catch (error) {\n            console.error(\"Health check with recovery failed:\", error);\n            return false;\n        }\n    }\n}\n// Middleware function to ensure database health before operations\nasync function ensureDatabaseHealth() {\n    const isHealthy = await DatabaseRetryHandler.healthCheckWithRecovery();\n    if (!isHealthy) {\n        throw new Error(\"Database is not available after recovery attempts\");\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RjtBQUNGO0FBRUEsa0VBQWtFO0FBQzNELGVBQWV5QjtJQUNwQixNQUFNOUIsWUFBWSxNQUFNVCxxQkFBcUJzQyx1QkFBdUI7SUFDcEUsSUFBSSxDQUFDN0IsV0FBVztRQUNkLE1BQU0sSUFBSU0sTUFBTTtJQUNsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vc2VydmVyL2RiLXJldHJ5LWhhbmRsZXIudHM/ZWU2ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkYXRhYmFzZU1hbmFnZXIgfSBmcm9tIFwiLi9kYlwiO1xuXG4vLyBEYXRhYmFzZSByZXRyeSBtZWNoYW5pc20gZm9yIGVuaGFuY2VkIHJlbGlhYmlsaXR5XG5leHBvcnQgY2xhc3MgRGF0YWJhc2VSZXRyeUhhbmRsZXIge1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBERUZBVUxUX01BWF9SRVRSSUVTID0gMztcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgREVGQVVMVF9CQUNLT0ZGX01TID0gMTAwMDtcblxuICAvLyBFeGVjdXRlIGRhdGFiYXNlIG9wZXJhdGlvbiB3aXRoIHJldHJ5IGxvZ2ljXG4gIHN0YXRpYyBhc3luYyB3aXRoUmV0cnk8VD4oXG4gICAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxuICAgIG1heFJldHJpZXM6IG51bWJlciA9IHRoaXMuREVGQVVMVF9NQVhfUkVUUklFUyxcbiAgICBiYWNrb2ZmTXM6IG51bWJlciA9IHRoaXMuREVGQVVMVF9CQUNLT0ZGX01TXG4gICk6IFByb21pc2U8VD4ge1xuICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGw7XG4gICAgXG4gICAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gbWF4UmV0cmllcyArIDE7IGF0dGVtcHQrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gQ2hlY2sgZGF0YWJhc2UgaGVhbHRoIGJlZm9yZSBleGVjdXRpbmdcbiAgICAgICAgY29uc3QgaXNIZWFsdGh5ID0gYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmhlYWx0aENoZWNrKCk7XG4gICAgICAgIGlmICghaXNIZWFsdGh5ICYmIGF0dGVtcHQgPT09IDEpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oJ0RhdGFiYXNlIGFwcGVhcnMgdW5oZWFsdGh5LCBhdHRlbXB0aW5nIHJlY29ubmVjdGlvbicpO1xuICAgICAgICAgIGF3YWl0IGRhdGFiYXNlTWFuYWdlci5mb3JjZVJlY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYXdhaXQgb3BlcmF0aW9uKCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsYXN0RXJyb3IgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSk7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLndhcm4oYERhdGFiYXNlIG9wZXJhdGlvbiBmYWlsZWQgKGF0dGVtcHQgJHthdHRlbXB0fS8ke21heFJldHJpZXMgKyAxfSk6YCwgbGFzdEVycm9yLm1lc3NhZ2UpO1xuICAgICAgICBcbiAgICAgICAgLy8gRG9uJ3QgcmV0cnkgb24gdGhlIGxhc3QgYXR0ZW1wdFxuICAgICAgICBpZiAoYXR0ZW1wdCA+IG1heFJldHJpZXMpIGJyZWFrO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIGNvbm5lY3Rpb24tcmVsYXRlZCBlcnJvclxuICAgICAgICBpZiAodGhpcy5pc0Nvbm5lY3Rpb25FcnJvcihsYXN0RXJyb3IpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ0Nvbm5lY3Rpb24gZXJyb3IgZGV0ZWN0ZWQsIGZvcmNpbmcgcmVjb25uZWN0aW9uJyk7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGRhdGFiYXNlTWFuYWdlci5mb3JjZVJlY29ubmVjdCgpO1xuICAgICAgICAgIH0gY2F0Y2ggKHJlY29ubmVjdEVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdSZWNvbm5lY3Rpb24gZmFpbGVkOicsIHJlY29ubmVjdEVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEV4cG9uZW50aWFsIGJhY2tvZmYgd2l0aCBqaXR0ZXJcbiAgICAgICAgY29uc3QgZGVsYXkgPSBiYWNrb2ZmTXMgKiBNYXRoLnBvdygyLCBhdHRlbXB0IC0gMSkgKyBNYXRoLnJhbmRvbSgpICogMTAwMDtcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIE1hdGgubWluKGRlbGF5LCAzMDAwMCkpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgbGFzdEVycm9yIHx8IG5ldyBFcnJvcignRGF0YWJhc2Ugb3BlcmF0aW9uIGZhaWxlZCBhZnRlciByZXRyaWVzJyk7XG4gIH1cblxuICAvLyBDaGVjayBpZiBlcnJvciBpcyBjb25uZWN0aW9uLXJlbGF0ZWRcbiAgcHJpdmF0ZSBzdGF0aWMgaXNDb25uZWN0aW9uRXJyb3IoZXJyb3I6IEVycm9yKTogYm9vbGVhbiB7XG4gICAgY29uc3QgY29ubmVjdGlvbkVycm9yUGF0dGVybnMgPSBbXG4gICAgICAvY29ubmVjdGlvbi9pLFxuICAgICAgL25ldHdvcmsvaSxcbiAgICAgIC90aW1lb3V0L2ksXG4gICAgICAvRUNPTk5SRVNFVC9pLFxuICAgICAgL0VOT1RGT1VORC9pLFxuICAgICAgL0VUSU1FRE9VVC9pLFxuICAgICAgL3NvY2tldC9pLFxuICAgICAgL3Bvb2wvaVxuICAgIF07XG4gICAgXG4gICAgcmV0dXJuIGNvbm5lY3Rpb25FcnJvclBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBcbiAgICAgIHBhdHRlcm4udGVzdChlcnJvci5tZXNzYWdlKSB8fCBwYXR0ZXJuLnRlc3QoZXJyb3IubmFtZSlcbiAgICApO1xuICB9XG5cbiAgLy8gRXhlY3V0ZSB0cmFuc2FjdGlvbiB3aXRoIHJldHJ5IGxvZ2ljXG4gIHN0YXRpYyBhc3luYyB3aXRoVHJhbnNhY3Rpb248VD4oXG4gICAgb3BlcmF0aW9uOiAodHg6IGFueSkgPT4gUHJvbWlzZTxUPixcbiAgICBtYXhSZXRyaWVzOiBudW1iZXIgPSAyIC8vIEZld2VyIHJldHJpZXMgZm9yIHRyYW5zYWN0aW9uc1xuICApOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBkYXRhYmFzZU1hbmFnZXIuZ2V0RGF0YWJhc2UoKTtcbiAgICAgIHJldHVybiBhd2FpdCBkYi50cmFuc2FjdGlvbihvcGVyYXRpb24pO1xuICAgIH0sIG1heFJldHJpZXMpO1xuICB9XG5cbiAgLy8gSGVhbHRoIGNoZWNrIHdpdGggYXV0b21hdGljIHJlY292ZXJ5XG4gIHN0YXRpYyBhc3luYyBoZWFsdGhDaGVja1dpdGhSZWNvdmVyeSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaXNIZWFsdGh5ID0gYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmhlYWx0aENoZWNrKCk7XG4gICAgICBcbiAgICAgIGlmICghaXNIZWFsdGh5KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZSBoZWFsdGggY2hlY2sgZmFpbGVkLCBhdHRlbXB0aW5nIHJlY292ZXJ5Jyk7XG4gICAgICAgIGF3YWl0IGRhdGFiYXNlTWFuYWdlci5mb3JjZVJlY29ubmVjdCgpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgYWdhaW4gYWZ0ZXIgcmVjb25uZWN0aW9uXG4gICAgICAgIHJldHVybiBhd2FpdCBkYXRhYmFzZU1hbmFnZXIuaGVhbHRoQ2hlY2soKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0hlYWx0aCBjaGVjayB3aXRoIHJlY292ZXJ5IGZhaWxlZDonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG59XG5cbi8vIE1pZGRsZXdhcmUgZnVuY3Rpb24gdG8gZW5zdXJlIGRhdGFiYXNlIGhlYWx0aCBiZWZvcmUgb3BlcmF0aW9uc1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZURhdGFiYXNlSGVhbHRoKCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBpc0hlYWx0aHkgPSBhd2FpdCBEYXRhYmFzZVJldHJ5SGFuZGxlci5oZWFsdGhDaGVja1dpdGhSZWNvdmVyeSgpO1xuICBpZiAoIWlzSGVhbHRoeSkge1xuICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgaXMgbm90IGF2YWlsYWJsZSBhZnRlciByZWNvdmVyeSBhdHRlbXB0cycpO1xuICB9XG59Il0sIm5hbWVzIjpbImRhdGFiYXNlTWFuYWdlciIsIkRhdGFiYXNlUmV0cnlIYW5kbGVyIiwiREVGQVVMVF9NQVhfUkVUUklFUyIsIkRFRkFVTFRfQkFDS09GRl9NUyIsIndpdGhSZXRyeSIsIm9wZXJhdGlvbiIsIm1heFJldHJpZXMiLCJiYWNrb2ZmTXMiLCJsYXN0RXJyb3IiLCJhdHRlbXB0IiwiaXNIZWFsdGh5IiwiaGVhbHRoQ2hlY2siLCJjb25zb2xlIiwid2FybiIsImZvcmNlUmVjb25uZWN0IiwiZXJyb3IiLCJFcnJvciIsIlN0cmluZyIsIm1lc3NhZ2UiLCJpc0Nvbm5lY3Rpb25FcnJvciIsImxvZyIsInJlY29ubmVjdEVycm9yIiwiZGVsYXkiLCJNYXRoIiwicG93IiwicmFuZG9tIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwibWluIiwiY29ubmVjdGlvbkVycm9yUGF0dGVybnMiLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJuYW1lIiwid2l0aFRyYW5zYWN0aW9uIiwiZGIiLCJnZXREYXRhYmFzZSIsInRyYW5zYWN0aW9uIiwiaGVhbHRoQ2hlY2tXaXRoUmVjb3ZlcnkiLCJlbnN1cmVEYXRhYmFzZUhlYWx0aCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./server/db-retry-handler.ts\n");

/***/ }),

/***/ "(api)/./server/db.ts":
/*!**********************!*\
  !*** ./server/db.ts ***!
  \**********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   databaseManager: () => (/* binding */ dbManager),\n/* harmony export */   db: () => (/* binding */ db),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   pool: () => (/* binding */ pool)\n/* harmony export */ });\n/* harmony import */ var _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @neondatabase/serverless */ \"@neondatabase/serverless\");\n/* harmony import */ var drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/neon-serverless */ \"drizzle-orm/neon-serverless\");\n/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ws */ \"ws\");\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @shared/schema */ \"(api)/./shared/schema.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__, drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__, ws__WEBPACK_IMPORTED_MODULE_2__, _shared_schema__WEBPACK_IMPORTED_MODULE_3__]);\n([_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__, drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__, ws__WEBPACK_IMPORTED_MODULE_2__, _shared_schema__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n// Enhanced Neon configuration for Replit environments\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.webSocketConstructor = ws__WEBPACK_IMPORTED_MODULE_2__[\"default\"];\n// Configure for better reliability in Replit\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.useSecureWebSocket = true;\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.pipelineConnect = false; // Disable for better Replit compatibility\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.fetchConnectionCache = true;\nif (!process.env.DATABASE_URL) {\n    throw new Error(\"DATABASE_URL must be set. Did you forget to provision a database?\");\n}\n// Enhanced pool configuration for Replit reliability\nconst poolConfig = {\n    connectionString: process.env.DATABASE_URL,\n    // Connection pool settings for stability\n    max: 10,\n    min: 2,\n    idleTimeoutMillis: 30000,\n    connectionTimeoutMillis: 10000,\n    // Retry configuration\n    maxUses: 7500,\n    keepAlive: true,\n    // Enhanced error handling\n    log: (msg, level)=>{\n        if (level === \"error\") {\n            console.error(\"Database pool error:\", msg);\n        } else if (true) {\n            console.log(\"Database pool:\", level, msg);\n        }\n    }\n};\nclass ReplitDatabaseManager {\n    constructor(){\n        this.pool = null;\n        this.db = null;\n        this.reconnectAttempts = 0;\n        this.maxReconnectAttempts = 5;\n        this.isReconnecting = false;\n    // Don't call initializeConnection in constructor to avoid sync issues\n    }\n    static getInstance() {\n        if (!ReplitDatabaseManager.instance) {\n            ReplitDatabaseManager.instance = new ReplitDatabaseManager();\n            // Initialize connection asynchronously\n            ReplitDatabaseManager.instance.initializeConnection().catch((error)=>{\n                console.error(\"Failed to initialize database during getInstance:\", error);\n            });\n        }\n        return ReplitDatabaseManager.instance;\n    }\n    async initializeConnection() {\n        try {\n            console.log(\"Initializing database connection for Replit environment\");\n            // Create pool with enhanced configuration\n            this.pool = new _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.Pool(poolConfig);\n            // Test the connection\n            const client = await this.pool.connect();\n            await client.query(\"SELECT 1\");\n            client.release();\n            // Initialize Drizzle with the pool\n            this.db = (0,drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__.drizzle)({\n                client: this.pool,\n                schema: _shared_schema__WEBPACK_IMPORTED_MODULE_3__\n            });\n            console.log(\"Database connection established successfully\");\n            this.reconnectAttempts = 0;\n            // Setup connection monitoring\n            this.setupConnectionMonitoring();\n        } catch (error) {\n            console.error(\"Failed to initialize database connection:\", error);\n            await this.handleConnectionError(error);\n        }\n    }\n    setupConnectionMonitoring() {\n        if (!this.pool) return;\n        // Monitor pool events\n        this.pool.on(\"error\", async (err)=>{\n            console.error(\"Database pool error:\", err);\n            await this.handleConnectionError(err);\n        });\n        this.pool.on(\"connect\", ()=>{\n            console.log(\"New database connection established\");\n        });\n        this.pool.on(\"remove\", ()=>{\n            console.log(\"Database connection removed from pool\");\n        });\n    }\n    async handleConnectionError(error) {\n        if (this.isReconnecting) return;\n        console.error(\"Database connection error:\", error);\n        if (this.reconnectAttempts < this.maxReconnectAttempts) {\n            this.isReconnecting = true;\n            this.reconnectAttempts++;\n            console.log(`Attempting to reconnect (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`);\n            // Wait with exponential backoff\n            const backoffMs = Math.min(1000 * Math.pow(2, this.reconnectAttempts - 1), 30000);\n            await new Promise((resolve)=>setTimeout(resolve, backoffMs));\n            try {\n                await this.closeConnection();\n                await this.initializeConnection();\n            } catch (reconnectError) {\n                console.error(\"Reconnection failed:\", reconnectError);\n            } finally{\n                this.isReconnecting = false;\n            }\n        } else {\n            console.error(\"Max reconnection attempts reached. Manual intervention required.\");\n        }\n    }\n    async closeConnection() {\n        try {\n            if (this.pool) {\n                await this.pool.end();\n                this.pool = null;\n                this.db = null;\n                console.log(\"Database connection closed\");\n            }\n        } catch (error) {\n            console.error(\"Error closing database connection:\", error);\n        }\n    }\n    async getDatabase() {\n        if (!this.db) {\n            console.log(\"Database not ready, attempting initialization...\");\n            await this.initializeConnection();\n            if (!this.db) {\n                throw new Error(\"Database initialization failed.\");\n            }\n        }\n        return this.db;\n    }\n    async getPool() {\n        if (!this.pool) {\n            console.log(\"Pool not ready, attempting initialization...\");\n            await this.initializeConnection();\n            if (!this.pool) {\n                throw new Error(\"Database pool initialization failed.\");\n            }\n        }\n        return this.pool;\n    }\n    async healthCheck() {\n        try {\n            if (!this.pool) return false;\n            const client = await this.pool.connect();\n            await client.query(\"SELECT 1\");\n            client.release();\n            return true;\n        } catch (error) {\n            console.error(\"Database health check failed:\", error);\n            return false;\n        }\n    }\n    // Force reconnection (useful for new tab scenarios)\n    async forceReconnect() {\n        console.log(\"Forcing database reconnection\");\n        this.reconnectAttempts = 0;\n        await this.closeConnection();\n        await this.initializeConnection();\n    }\n}\n// Initialize the database manager\nconst dbManager = ReplitDatabaseManager.getInstance();\n// Create lazy-loaded exports that initialize on first access\nlet poolPromise = null;\nlet dbPromise = null;\nconst getPool = ()=>{\n    if (!poolPromise) {\n        poolPromise = dbManager.getPool();\n    }\n    return poolPromise;\n};\nconst getDb = ()=>{\n    if (!dbPromise) {\n        dbPromise = dbManager.getDatabase();\n    }\n    return dbPromise;\n};\n// Legacy exports for backward compatibility - these will initialize synchronously if possible\nconst pool = new Proxy({}, {\n    get: (target, prop)=>{\n        throw new Error(\"Use getPool() instead for async pool access\");\n    }\n});\nconst db = new Proxy({}, {\n    get: (target, prop)=>{\n        throw new Error(\"Use getDb() instead for async database access\");\n    }\n});\n\n// Graceful shutdown handling\nprocess.on(\"SIGINT\", async ()=>{\n    console.log(\"Received SIGINT, closing database connections...\");\n    await dbManager.closeConnection();\n    process.exit(0);\n});\nprocess.on(\"SIGTERM\", async ()=>{\n    console.log(\"Received SIGTERM, closing database connections...\");\n    await dbManager.closeConnection();\n    process.exit(0);\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUEsa0NBQWtDO0FBQ2xDLE1BQU11QixZQUFZL0Isc0JBQXNCTSxXQUFXO0FBRW5ELDZEQUE2RDtBQUM3RCxJQUFJMEIsY0FBb0M7QUFDeEMsSUFBSUMsWUFBd0Q7QUFFckQsTUFBTUwsVUFBVTtJQUNyQixJQUFJLENBQUNJLGFBQWE7UUFDaEJBLGNBQWNELFVBQVVILE9BQU87SUFDakM7SUFDQSxPQUFPSTtBQUNULEVBQUU7QUFFSyxNQUFNRSxRQUFRO0lBQ25CLElBQUksQ0FBQ0QsV0FBVztRQUNkQSxZQUFZRixVQUFVSixXQUFXO0lBQ25DO0lBQ0EsT0FBT007QUFDVCxFQUFFO0FBRUYsOEZBQThGO0FBQ3ZGLE1BQU1oQyxPQUFPLElBQUlrQyxNQUFNLENBQUMsR0FBVztJQUN4Q0MsS0FBSyxDQUFDQyxRQUFRQztRQUNaLE1BQU0sSUFBSXBELE1BQU07SUFDbEI7QUFDRixHQUFHO0FBRUksTUFBTWdCLEtBQUssSUFBSWlDLE1BQU0sQ0FBQyxHQUFpQztJQUM1REMsS0FBSyxDQUFDQyxRQUFRQztRQUNaLE1BQU0sSUFBSXBELE1BQU07SUFDbEI7QUFDRixHQUFHO0FBRXFDO0FBRXhDLDZCQUE2QjtBQUM3QkgsUUFBUWlDLEVBQUUsQ0FBQyxVQUFVO0lBQ25CbEIsUUFBUUgsR0FBRyxDQUFDO0lBQ1osTUFBTW9DLFVBQVVQLGVBQWU7SUFDL0J6QyxRQUFReUQsSUFBSSxDQUFDO0FBQ2Y7QUFFQXpELFFBQVFpQyxFQUFFLENBQUMsV0FBVztJQUNwQmxCLFFBQVFILEdBQUcsQ0FBQztJQUNaLE1BQU1vQyxVQUFVUCxlQUFlO0lBQy9CekMsUUFBUXlELElBQUksQ0FBQztBQUNmIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vc2VydmVyL2RiLnRzP2JlNjIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9vbCwgbmVvbkNvbmZpZywgUG9vbENvbmZpZyB9IGZyb20gJ0BuZW9uZGF0YWJhc2Uvc2VydmVybGVzcyc7XG5pbXBvcnQgeyBkcml6emxlIH0gZnJvbSAnZHJpenpsZS1vcm0vbmVvbi1zZXJ2ZXJsZXNzJztcbmltcG9ydCB3cyBmcm9tIFwid3NcIjtcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcblxuLy8gRW5oYW5jZWQgTmVvbiBjb25maWd1cmF0aW9uIGZvciBSZXBsaXQgZW52aXJvbm1lbnRzXG5uZW9uQ29uZmlnLndlYlNvY2tldENvbnN0cnVjdG9yID0gd3M7XG5cbi8vIENvbmZpZ3VyZSBmb3IgYmV0dGVyIHJlbGlhYmlsaXR5IGluIFJlcGxpdFxubmVvbkNvbmZpZy51c2VTZWN1cmVXZWJTb2NrZXQgPSB0cnVlO1xubmVvbkNvbmZpZy5waXBlbGluZUNvbm5lY3QgPSBmYWxzZTsgLy8gRGlzYWJsZSBmb3IgYmV0dGVyIFJlcGxpdCBjb21wYXRpYmlsaXR5XG5uZW9uQ29uZmlnLmZldGNoQ29ubmVjdGlvbkNhY2hlID0gdHJ1ZTtcblxuaWYgKCFwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwpIHtcbiAgdGhyb3cgbmV3IEVycm9yKFxuICAgIFwiREFUQUJBU0VfVVJMIG11c3QgYmUgc2V0LiBEaWQgeW91IGZvcmdldCB0byBwcm92aXNpb24gYSBkYXRhYmFzZT9cIixcbiAgKTtcbn1cblxuLy8gRW5oYW5jZWQgcG9vbCBjb25maWd1cmF0aW9uIGZvciBSZXBsaXQgcmVsaWFiaWxpdHlcbmNvbnN0IHBvb2xDb25maWc6IFBvb2xDb25maWcgPSB7XG4gIGNvbm5lY3Rpb25TdHJpbmc6IHByb2Nlc3MuZW52LkRBVEFCQVNFX1VSTCxcbiAgLy8gQ29ubmVjdGlvbiBwb29sIHNldHRpbmdzIGZvciBzdGFiaWxpdHlcbiAgbWF4OiAxMCwgLy8gTWF4aW11bSBjb25uZWN0aW9uc1xuICBtaW46IDIsICAvLyBNaW5pbXVtIGNvbm5lY3Rpb25zXG4gIGlkbGVUaW1lb3V0TWlsbGlzOiAzMDAwMCwgLy8gMzAgc2Vjb25kc1xuICBjb25uZWN0aW9uVGltZW91dE1pbGxpczogMTAwMDAsIC8vIDEwIHNlY29uZHNcbiAgLy8gUmV0cnkgY29uZmlndXJhdGlvblxuICBtYXhVc2VzOiA3NTAwLCAvLyBNYXhpbXVtIHVzZXMgcGVyIGNvbm5lY3Rpb25cbiAga2VlcEFsaXZlOiB0cnVlLFxuICAvLyBFbmhhbmNlZCBlcnJvciBoYW5kbGluZ1xuICBsb2c6IChtc2csIGxldmVsKSA9PiB7XG4gICAgaWYgKGxldmVsID09PSAnZXJyb3InKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBwb29sIGVycm9yOicsIG1zZyk7XG4gICAgfSBlbHNlIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIHBvb2w6JywgbGV2ZWwsIG1zZyk7XG4gICAgfVxuICB9XG59O1xuXG5jbGFzcyBSZXBsaXREYXRhYmFzZU1hbmFnZXIge1xuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUmVwbGl0RGF0YWJhc2VNYW5hZ2VyO1xuICBwcml2YXRlIHBvb2w6IFBvb2wgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBkYjogUmV0dXJuVHlwZTx0eXBlb2YgZHJpenpsZT4gfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZWNvbm5lY3RBdHRlbXB0cyA9IDA7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWF4UmVjb25uZWN0QXR0ZW1wdHMgPSA1O1xuICBwcml2YXRlIGlzUmVjb25uZWN0aW5nID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBEb24ndCBjYWxsIGluaXRpYWxpemVDb25uZWN0aW9uIGluIGNvbnN0cnVjdG9yIHRvIGF2b2lkIHN5bmMgaXNzdWVzXG4gIH1cblxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogUmVwbGl0RGF0YWJhc2VNYW5hZ2VyIHtcbiAgICBpZiAoIVJlcGxpdERhdGFiYXNlTWFuYWdlci5pbnN0YW5jZSkge1xuICAgICAgUmVwbGl0RGF0YWJhc2VNYW5hZ2VyLmluc3RhbmNlID0gbmV3IFJlcGxpdERhdGFiYXNlTWFuYWdlcigpO1xuICAgICAgLy8gSW5pdGlhbGl6ZSBjb25uZWN0aW9uIGFzeW5jaHJvbm91c2x5XG4gICAgICBSZXBsaXREYXRhYmFzZU1hbmFnZXIuaW5zdGFuY2UuaW5pdGlhbGl6ZUNvbm5lY3Rpb24oKS5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIGRhdGFiYXNlIGR1cmluZyBnZXRJbnN0YW5jZTonLCBlcnJvcik7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIFJlcGxpdERhdGFiYXNlTWFuYWdlci5pbnN0YW5jZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZUNvbm5lY3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdJbml0aWFsaXppbmcgZGF0YWJhc2UgY29ubmVjdGlvbiBmb3IgUmVwbGl0IGVudmlyb25tZW50Jyk7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBwb29sIHdpdGggZW5oYW5jZWQgY29uZmlndXJhdGlvblxuICAgICAgdGhpcy5wb29sID0gbmV3IFBvb2wocG9vbENvbmZpZyk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgdGhlIGNvbm5lY3Rpb25cbiAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IHRoaXMucG9vbC5jb25uZWN0KCk7XG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoJ1NFTEVDVCAxJyk7XG4gICAgICBjbGllbnQucmVsZWFzZSgpO1xuICAgICAgXG4gICAgICAvLyBJbml0aWFsaXplIERyaXp6bGUgd2l0aCB0aGUgcG9vbFxuICAgICAgdGhpcy5kYiA9IGRyaXp6bGUoeyBjbGllbnQ6IHRoaXMucG9vbCwgc2NoZW1hIH0pO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiBlc3RhYmxpc2hlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgPSAwO1xuICAgICAgXG4gICAgICAvLyBTZXR1cCBjb25uZWN0aW9uIG1vbml0b3JpbmdcbiAgICAgIHRoaXMuc2V0dXBDb25uZWN0aW9uTW9uaXRvcmluZygpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBpbml0aWFsaXplIGRhdGFiYXNlIGNvbm5lY3Rpb246JywgZXJyb3IpO1xuICAgICAgYXdhaXQgdGhpcy5oYW5kbGVDb25uZWN0aW9uRXJyb3IoZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0dXBDb25uZWN0aW9uTW9uaXRvcmluZygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMucG9vbCkgcmV0dXJuO1xuXG4gICAgLy8gTW9uaXRvciBwb29sIGV2ZW50c1xuICAgIHRoaXMucG9vbC5vbignZXJyb3InLCBhc3luYyAoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBwb29sIGVycm9yOicsIGVycik7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUNvbm5lY3Rpb25FcnJvcihlcnIpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wb29sLm9uKCdjb25uZWN0JywgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ05ldyBkYXRhYmFzZSBjb25uZWN0aW9uIGVzdGFibGlzaGVkJyk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnBvb2wub24oJ3JlbW92ZScsICgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdEYXRhYmFzZSBjb25uZWN0aW9uIHJlbW92ZWQgZnJvbSBwb29sJyk7XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGhhbmRsZUNvbm5lY3Rpb25FcnJvcihlcnJvcjogYW55KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgaWYgKHRoaXMuaXNSZWNvbm5lY3RpbmcpIHJldHVybjtcbiAgICBcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICBcbiAgICBpZiAodGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA8IHRoaXMubWF4UmVjb25uZWN0QXR0ZW1wdHMpIHtcbiAgICAgIHRoaXMuaXNSZWNvbm5lY3RpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cysrO1xuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhgQXR0ZW1wdGluZyB0byByZWNvbm5lY3QgKGF0dGVtcHQgJHt0aGlzLnJlY29ubmVjdEF0dGVtcHRzfS8ke3RoaXMubWF4UmVjb25uZWN0QXR0ZW1wdHN9KWApO1xuICAgICAgXG4gICAgICAvLyBXYWl0IHdpdGggZXhwb25lbnRpYWwgYmFja29mZlxuICAgICAgY29uc3QgYmFja29mZk1zID0gTWF0aC5taW4oMTAwMCAqIE1hdGgucG93KDIsIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgLSAxKSwgMzAwMDApO1xuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGJhY2tvZmZNcykpO1xuICAgICAgXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmNsb3NlQ29ubmVjdGlvbigpO1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDb25uZWN0aW9uKCk7XG4gICAgICB9IGNhdGNoIChyZWNvbm5lY3RFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdSZWNvbm5lY3Rpb24gZmFpbGVkOicsIHJlY29ubmVjdEVycm9yKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRoaXMuaXNSZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcignTWF4IHJlY29ubmVjdGlvbiBhdHRlbXB0cyByZWFjaGVkLiBNYW51YWwgaW50ZXJ2ZW50aW9uIHJlcXVpcmVkLicpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNsb3NlQ29ubmVjdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHRoaXMucG9vbCkge1xuICAgICAgICBhd2FpdCB0aGlzLnBvb2wuZW5kKCk7XG4gICAgICAgIHRoaXMucG9vbCA9IG51bGw7XG4gICAgICAgIHRoaXMuZGIgPSBudWxsO1xuICAgICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiBjbG9zZWQnKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY2xvc2luZyBkYXRhYmFzZSBjb25uZWN0aW9uOicsIGVycm9yKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZXREYXRhYmFzZSgpOiBQcm9taXNlPFJldHVyblR5cGU8dHlwZW9mIGRyaXp6bGU+PiB7XG4gICAgaWYgKCF0aGlzLmRiKSB7XG4gICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2Ugbm90IHJlYWR5LCBhdHRlbXB0aW5nIGluaXRpYWxpemF0aW9uLi4uJyk7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDb25uZWN0aW9uKCk7XG4gICAgICBpZiAoIXRoaXMuZGIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBpbml0aWFsaXphdGlvbiBmYWlsZWQuJyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmRiO1xuICB9XG5cbiAgYXN5bmMgZ2V0UG9vbCgpOiBQcm9taXNlPFBvb2w+IHtcbiAgICBpZiAoIXRoaXMucG9vbCkge1xuICAgICAgY29uc29sZS5sb2coJ1Bvb2wgbm90IHJlYWR5LCBhdHRlbXB0aW5nIGluaXRpYWxpemF0aW9uLi4uJyk7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDb25uZWN0aW9uKCk7XG4gICAgICBpZiAoIXRoaXMucG9vbCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RhdGFiYXNlIHBvb2wgaW5pdGlhbGl6YXRpb24gZmFpbGVkLicpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5wb29sO1xuICB9XG5cbiAgYXN5bmMgaGVhbHRoQ2hlY2soKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghdGhpcy5wb29sKSByZXR1cm4gZmFsc2U7XG4gICAgICBcbiAgICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IHRoaXMucG9vbC5jb25uZWN0KCk7XG4gICAgICBhd2FpdCBjbGllbnQucXVlcnkoJ1NFTEVDVCAxJyk7XG4gICAgICBjbGllbnQucmVsZWFzZSgpO1xuICAgICAgXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgaGVhbHRoIGNoZWNrIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgLy8gRm9yY2UgcmVjb25uZWN0aW9uICh1c2VmdWwgZm9yIG5ldyB0YWIgc2NlbmFyaW9zKVxuICBhc3luYyBmb3JjZVJlY29ubmVjdCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zb2xlLmxvZygnRm9yY2luZyBkYXRhYmFzZSByZWNvbm5lY3Rpb24nKTtcbiAgICB0aGlzLnJlY29ubmVjdEF0dGVtcHRzID0gMDtcbiAgICBhd2FpdCB0aGlzLmNsb3NlQ29ubmVjdGlvbigpO1xuICAgIGF3YWl0IHRoaXMuaW5pdGlhbGl6ZUNvbm5lY3Rpb24oKTtcbiAgfVxufVxuXG4vLyBJbml0aWFsaXplIHRoZSBkYXRhYmFzZSBtYW5hZ2VyXG5jb25zdCBkYk1hbmFnZXIgPSBSZXBsaXREYXRhYmFzZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcblxuLy8gQ3JlYXRlIGxhenktbG9hZGVkIGV4cG9ydHMgdGhhdCBpbml0aWFsaXplIG9uIGZpcnN0IGFjY2Vzc1xubGV0IHBvb2xQcm9taXNlOiBQcm9taXNlPFBvb2w+IHwgbnVsbCA9IG51bGw7XG5sZXQgZGJQcm9taXNlOiBQcm9taXNlPFJldHVyblR5cGU8dHlwZW9mIGRyaXp6bGU+PiB8IG51bGwgPSBudWxsO1xuXG5leHBvcnQgY29uc3QgZ2V0UG9vbCA9ICgpOiBQcm9taXNlPFBvb2w+ID0+IHtcbiAgaWYgKCFwb29sUHJvbWlzZSkge1xuICAgIHBvb2xQcm9taXNlID0gZGJNYW5hZ2VyLmdldFBvb2woKTtcbiAgfVxuICByZXR1cm4gcG9vbFByb21pc2U7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RGIgPSAoKTogUHJvbWlzZTxSZXR1cm5UeXBlPHR5cGVvZiBkcml6emxlPj4gPT4ge1xuICBpZiAoIWRiUHJvbWlzZSkge1xuICAgIGRiUHJvbWlzZSA9IGRiTWFuYWdlci5nZXREYXRhYmFzZSgpO1xuICB9XG4gIHJldHVybiBkYlByb21pc2U7XG59O1xuXG4vLyBMZWdhY3kgZXhwb3J0cyBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eSAtIHRoZXNlIHdpbGwgaW5pdGlhbGl6ZSBzeW5jaHJvbm91c2x5IGlmIHBvc3NpYmxlXG5leHBvcnQgY29uc3QgcG9vbCA9IG5ldyBQcm94eSh7fSBhcyBQb29sLCB7XG4gIGdldDogKHRhcmdldCwgcHJvcCkgPT4ge1xuICAgIHRocm93IG5ldyBFcnJvcignVXNlIGdldFBvb2woKSBpbnN0ZWFkIGZvciBhc3luYyBwb29sIGFjY2VzcycpO1xuICB9XG59KTtcblxuZXhwb3J0IGNvbnN0IGRiID0gbmV3IFByb3h5KHt9IGFzIFJldHVyblR5cGU8dHlwZW9mIGRyaXp6bGU+LCB7XG4gIGdldDogKHRhcmdldCwgcHJvcCkgPT4ge1xuICAgIHRocm93IG5ldyBFcnJvcignVXNlIGdldERiKCkgaW5zdGVhZCBmb3IgYXN5bmMgZGF0YWJhc2UgYWNjZXNzJyk7XG4gIH1cbn0pO1xuXG5leHBvcnQgeyBkYk1hbmFnZXIgYXMgZGF0YWJhc2VNYW5hZ2VyIH07XG5cbi8vIEdyYWNlZnVsIHNodXRkb3duIGhhbmRsaW5nXG5wcm9jZXNzLm9uKCdTSUdJTlQnLCBhc3luYyAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdSZWNlaXZlZCBTSUdJTlQsIGNsb3NpbmcgZGF0YWJhc2UgY29ubmVjdGlvbnMuLi4nKTtcbiAgYXdhaXQgZGJNYW5hZ2VyLmNsb3NlQ29ubmVjdGlvbigpO1xuICBwcm9jZXNzLmV4aXQoMCk7XG59KTtcblxucHJvY2Vzcy5vbignU0lHVEVSTScsIGFzeW5jICgpID0+IHtcbiAgY29uc29sZS5sb2coJ1JlY2VpdmVkIFNJR1RFUk0sIGNsb3NpbmcgZGF0YWJhc2UgY29ubmVjdGlvbnMuLi4nKTtcbiAgYXdhaXQgZGJNYW5hZ2VyLmNsb3NlQ29ubmVjdGlvbigpO1xuICBwcm9jZXNzLmV4aXQoMCk7XG59KTtcbiJdLCJuYW1lcyI6WyJQb29sIiwibmVvbkNvbmZpZyIsImRyaXp6bGUiLCJ3cyIsInNjaGVtYSIsIndlYlNvY2tldENvbnN0cnVjdG9yIiwidXNlU2VjdXJlV2ViU29ja2V0IiwicGlwZWxpbmVDb25uZWN0IiwiZmV0Y2hDb25uZWN0aW9uQ2FjaGUiLCJwcm9jZXNzIiwiZW52IiwiREFUQUJBU0VfVVJMIiwiRXJyb3IiLCJwb29sQ29uZmlnIiwiY29ubmVjdGlvblN0cmluZyIsIm1heCIsIm1pbiIsImlkbGVUaW1lb3V0TWlsbGlzIiwiY29ubmVjdGlvblRpbWVvdXRNaWxsaXMiLCJtYXhVc2VzIiwia2VlcEFsaXZlIiwibG9nIiwibXNnIiwibGV2ZWwiLCJjb25zb2xlIiwiZXJyb3IiLCJSZXBsaXREYXRhYmFzZU1hbmFnZXIiLCJwb29sIiwiZGIiLCJyZWNvbm5lY3RBdHRlbXB0cyIsIm1heFJlY29ubmVjdEF0dGVtcHRzIiwiaXNSZWNvbm5lY3RpbmciLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiaW5pdGlhbGl6ZUNvbm5lY3Rpb24iLCJjYXRjaCIsImNsaWVudCIsImNvbm5lY3QiLCJxdWVyeSIsInJlbGVhc2UiLCJzZXR1cENvbm5lY3Rpb25Nb25pdG9yaW5nIiwiaGFuZGxlQ29ubmVjdGlvbkVycm9yIiwib24iLCJlcnIiLCJiYWNrb2ZmTXMiLCJNYXRoIiwicG93IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiY2xvc2VDb25uZWN0aW9uIiwicmVjb25uZWN0RXJyb3IiLCJlbmQiLCJnZXREYXRhYmFzZSIsImdldFBvb2wiLCJoZWFsdGhDaGVjayIsImZvcmNlUmVjb25uZWN0IiwiZGJNYW5hZ2VyIiwicG9vbFByb21pc2UiLCJkYlByb21pc2UiLCJnZXREYiIsIlByb3h5IiwiZ2V0IiwidGFyZ2V0IiwicHJvcCIsImRhdGFiYXNlTWFuYWdlciIsImV4aXQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./server/db.ts\n");

/***/ }),

/***/ "(api)/./server/storage.ts":
/*!***************************!*\
  !*** ./server/storage.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseStorage: () => (/* binding */ DatabaseStorage),\n/* harmony export */   storage: () => (/* binding */ storage)\n/* harmony export */ });\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @shared/schema */ \"(api)/./shared/schema.ts\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db */ \"(api)/./server/db.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm */ \"drizzle-orm\");\n/* harmony import */ var _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db-retry-handler */ \"(api)/./server/db-retry-handler.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_shared_schema__WEBPACK_IMPORTED_MODULE_0__, _db__WEBPACK_IMPORTED_MODULE_1__, drizzle_orm__WEBPACK_IMPORTED_MODULE_2__, _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__]);\n([_shared_schema__WEBPACK_IMPORTED_MODULE_0__, _db__WEBPACK_IMPORTED_MODULE_1__, drizzle_orm__WEBPACK_IMPORTED_MODULE_2__, _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\nclass DatabaseStorage {\n    async getUser(id) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [user] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.id, id));\n            return user || undefined;\n        });\n    }\n    async getUserByUsername(username) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [user] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.username, username));\n            return user || undefined;\n        });\n    }\n    async createUser(insertUser) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [user] = await db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).values(insertUser).returning();\n            return user;\n        });\n    }\n    async addToWaitlist(insertEmail) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            try {\n                const [waitlistEmail] = await db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails).values(insertEmail).returning();\n                return waitlistEmail;\n            } catch (error) {\n                if (error.code === \"23505\") {\n                    throw new Error(\"Email already registered for waitlist\");\n                }\n                throw error;\n            }\n        });\n    }\n    async getWaitlistEmails() {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            return await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails);\n        });\n    }\n    async isEmailInWaitlist(email) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [result] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails.email, email));\n            return !!result;\n        });\n    }\n    async getUserSubjects(userId) {\n        try {\n            // Check database health before querying\n            const isHealthy = await _db__WEBPACK_IMPORTED_MODULE_1__.databaseManager.healthCheck();\n            if (!isHealthy) {\n                console.log(\"Database connection unhealthy, attempting to reconnect...\");\n                await _db__WEBPACK_IMPORTED_MODULE_1__.databaseManager.forceReconnect();\n            }\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const result = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.desc)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.dateAdded));\n            console.log(`Retrieved ${result.length} subjects for user ${userId}`);\n            return result;\n        } catch (error) {\n            console.error(\"Error in getUserSubjects:\", error);\n            throw new Error(\"Failed to retrieve user subjects from database\");\n        }\n    }\n    async addUserSubject(userSubject) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [subject] = await db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).values(userSubject).returning();\n            return subject;\n        });\n    }\n    async removeUserSubject(userId, subjectId) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            await db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.subjectId, subjectId)));\n        });\n    }\n    async hasUserSubject(userId, subjectId) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [result] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.subjectId, subjectId)));\n            return !!result;\n        });\n    }\n    async updateSubjectMasteryLevel(userId, subjectId, masteryLevel) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            await (0,_db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.ensureDatabaseHealth)();\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [updatedSubject] = await db.update(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).set({\n                masteryLevel\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.subjectId, subjectId))).returning();\n            return updatedSubject || null;\n        });\n    }\n}\nconst storage = new DatabaseStorage();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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d0RBQVlBLENBQUNpRCxTQUFTLEVBQUVBO1FBRWpDO0lBQ0Y7SUFFQSxNQUFNRSxlQUFlZixNQUFjLEVBQUVhLFNBQWlCLEVBQW9CO1FBQ3hFLE9BQU8zQyxtRUFBb0JBLENBQUNLLFNBQVMsQ0FBQztZQUNwQyxNQUFNSix1RUFBb0JBO1lBQzFCLE1BQU1LLEtBQUssTUFBTVgsMENBQUtBO1lBQ3RCLE1BQU0sQ0FBQ2lDLE9BQU8sR0FBRyxNQUFNdEIsR0FDcEJFLE1BQU0sR0FDTkMsSUFBSSxDQUFDZix3REFBWUEsRUFDakJnQixLQUFLLENBQUNaLGdEQUFHQSxDQUNSRCwrQ0FBRUEsQ0FBQ0gsd0RBQVlBLENBQUNvQyxNQUFNLEVBQUVBLFNBQ3hCakMsK0NBQUVBLENBQUNILHdEQUFZQSxDQUFDaUQsU0FBUyxFQUFFQTtZQUUvQixPQUFPLENBQUMsQ0FBQ2Y7UUFDWDtJQUNGO0lBRUEsTUFBTWtCLDBCQUEwQmhCLE1BQWMsRUFBRWEsU0FBaUIsRUFBRUksWUFBb0IsRUFBK0I7UUFDcEgsT0FBTy9DLG1FQUFvQkEsQ0FBQ0ssU0FBUyxDQUFDO1lBQ3BDLE1BQU1KLHVFQUFvQkE7WUFDMUIsTUFBTUssS0FBSyxNQUFNWCwwQ0FBS0E7WUFDdEIsTUFBTSxDQUFDcUQsZUFBZSxHQUFHLE1BQU0xQyxHQUM1QjJDLE1BQU0sQ0FBQ3ZELHdEQUFZQSxFQUNuQndELEdBQUcsQ0FBQztnQkFBRUg7WUFBYSxHQUNuQnJDLEtBQUssQ0FBQ1osZ0RBQUdBLENBQ1JELCtDQUFFQSxDQUFDSCx3REFBWUEsQ0FBQ29DLE1BQU0sRUFBRUEsU0FDeEJqQywrQ0FBRUEsQ0FBQ0gsd0RBQVlBLENBQUNpRCxTQUFTLEVBQUVBLGFBRTVCekIsU0FBUztZQUNaLE9BQU84QixrQkFBa0I7UUFDM0I7SUFDRjtBQUNGO0FBRU8sTUFBTUcsVUFBVSxJQUFJakQsa0JBQWtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vc2VydmVyL3N0b3JhZ2UudHM/Y2M0OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1c2Vycywgd2FpdGxpc3RFbWFpbHMsIHVzZXJTdWJqZWN0cywgdHlwZSBVc2VyLCB0eXBlIEluc2VydFVzZXIsIHR5cGUgV2FpdGxpc3RFbWFpbCwgdHlwZSBJbnNlcnRXYWl0bGlzdEVtYWlsLCB0eXBlIFVzZXJTdWJqZWN0LCB0eXBlIEluc2VydFVzZXJTdWJqZWN0IH0gZnJvbSBcIkBzaGFyZWQvc2NoZW1hXCI7XG5pbXBvcnQgeyBnZXREYiwgZGF0YWJhc2VNYW5hZ2VyIH0gZnJvbSBcIi4vZGJcIjtcbmltcG9ydCB7IGVxLCBhbmQsIGRlc2MgfSBmcm9tIFwiZHJpenpsZS1vcm1cIjtcbmltcG9ydCB7IERhdGFiYXNlUmV0cnlIYW5kbGVyLCBlbnN1cmVEYXRhYmFzZUhlYWx0aCB9IGZyb20gXCIuL2RiLXJldHJ5LWhhbmRsZXJcIjtcblxuZXhwb3J0IGludGVyZmFjZSBJU3RvcmFnZSB7XG4gIGdldFVzZXIoaWQ6IG51bWJlcik6IFByb21pc2U8VXNlciB8IHVuZGVmaW5lZD47XG4gIGdldFVzZXJCeVVzZXJuYW1lKHVzZXJuYW1lOiBzdHJpbmcpOiBQcm9taXNlPFVzZXIgfCB1bmRlZmluZWQ+O1xuICBjcmVhdGVVc2VyKHVzZXI6IEluc2VydFVzZXIpOiBQcm9taXNlPFVzZXI+O1xuICBhZGRUb1dhaXRsaXN0KGVtYWlsOiBJbnNlcnRXYWl0bGlzdEVtYWlsKTogUHJvbWlzZTxXYWl0bGlzdEVtYWlsPjtcbiAgZ2V0V2FpdGxpc3RFbWFpbHMoKTogUHJvbWlzZTxXYWl0bGlzdEVtYWlsW10+O1xuICBpc0VtYWlsSW5XYWl0bGlzdChlbWFpbDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPjtcbiAgZ2V0VXNlclN1YmplY3RzKHVzZXJJZDogbnVtYmVyKTogUHJvbWlzZTxVc2VyU3ViamVjdFtdPjtcbiAgYWRkVXNlclN1YmplY3QodXNlclN1YmplY3Q6IEluc2VydFVzZXJTdWJqZWN0KTogUHJvbWlzZTxVc2VyU3ViamVjdD47XG4gIHJlbW92ZVVzZXJTdWJqZWN0KHVzZXJJZDogbnVtYmVyLCBzdWJqZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD47XG4gIGhhc1VzZXJTdWJqZWN0KHVzZXJJZDogbnVtYmVyLCBzdWJqZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG4gIHVwZGF0ZVN1YmplY3RNYXN0ZXJ5TGV2ZWwodXNlcklkOiBudW1iZXIsIHN1YmplY3RJZDogc3RyaW5nLCBtYXN0ZXJ5TGV2ZWw6IG51bWJlcik6IFByb21pc2U8VXNlclN1YmplY3QgfCBudWxsPjtcbn1cblxuZXhwb3J0IGNsYXNzIERhdGFiYXNlU3RvcmFnZSBpbXBsZW1lbnRzIElTdG9yYWdlIHtcbiAgYXN5bmMgZ2V0VXNlcihpZDogbnVtYmVyKTogUHJvbWlzZTxVc2VyIHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3VzZXJdID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh1c2Vycykud2hlcmUoZXEodXNlcnMuaWQsIGlkKSk7XG4gICAgICByZXR1cm4gdXNlciB8fCB1bmRlZmluZWQ7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZTogc3RyaW5nKTogUHJvbWlzZTxVc2VyIHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3VzZXJdID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh1c2Vycykud2hlcmUoZXEodXNlcnMudXNlcm5hbWUsIHVzZXJuYW1lKSk7XG4gICAgICByZXR1cm4gdXNlciB8fCB1bmRlZmluZWQ7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBjcmVhdGVVc2VyKGluc2VydFVzZXI6IEluc2VydFVzZXIpOiBQcm9taXNlPFVzZXI+IHtcbiAgICByZXR1cm4gRGF0YWJhc2VSZXRyeUhhbmRsZXIud2l0aFJldHJ5KGFzeW5jICgpID0+IHtcbiAgICAgIGF3YWl0IGVuc3VyZURhdGFiYXNlSGVhbHRoKCk7XG4gICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiKCk7XG4gICAgICBjb25zdCBbdXNlcl0gPSBhd2FpdCBkYlxuICAgICAgICAuaW5zZXJ0KHVzZXJzKVxuICAgICAgICAudmFsdWVzKGluc2VydFVzZXIpXG4gICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgIHJldHVybiB1c2VyO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgYWRkVG9XYWl0bGlzdChpbnNlcnRFbWFpbDogSW5zZXJ0V2FpdGxpc3RFbWFpbCk6IFByb21pc2U8V2FpdGxpc3RFbWFpbD4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZW5zdXJlRGF0YWJhc2VIZWFsdGgoKTtcbiAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGIoKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IFt3YWl0bGlzdEVtYWlsXSA9IGF3YWl0IGRiXG4gICAgICAgICAgLmluc2VydCh3YWl0bGlzdEVtYWlscylcbiAgICAgICAgICAudmFsdWVzKGluc2VydEVtYWlsKVxuICAgICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgICAgcmV0dXJuIHdhaXRsaXN0RW1haWw7XG4gICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgIGlmIChlcnJvci5jb2RlID09PSAnMjM1MDUnKSB7IC8vIFBvc3RncmVTUUwgdW5pcXVlIGNvbnN0cmFpbnQgdmlvbGF0aW9uXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRW1haWwgYWxyZWFkeSByZWdpc3RlcmVkIGZvciB3YWl0bGlzdFwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGdldFdhaXRsaXN0RW1haWxzKCk6IFByb21pc2U8V2FpdGxpc3RFbWFpbFtdPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgcmV0dXJuIGF3YWl0IGRiLnNlbGVjdCgpLmZyb20od2FpdGxpc3RFbWFpbHMpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgaXNFbWFpbEluV2FpdGxpc3QoZW1haWw6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgZW5zdXJlRGF0YWJhc2VIZWFsdGgoKTtcbiAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGIoKTtcbiAgICAgIGNvbnN0IFtyZXN1bHRdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKHdhaXRsaXN0RW1haWxzKVxuICAgICAgICAud2hlcmUoZXEod2FpdGxpc3RFbWFpbHMuZW1haWwsIGVtYWlsKSk7XG4gICAgICByZXR1cm4gISFyZXN1bHQ7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRVc2VyU3ViamVjdHModXNlcklkOiBudW1iZXIpOiBQcm9taXNlPFVzZXJTdWJqZWN0W10+IHtcbiAgICB0cnkge1xuICAgICAgLy8gQ2hlY2sgZGF0YWJhc2UgaGVhbHRoIGJlZm9yZSBxdWVyeWluZ1xuICAgICAgY29uc3QgaXNIZWFsdGh5ID0gYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmhlYWx0aENoZWNrKCk7XG4gICAgICBpZiAoIWlzSGVhbHRoeSkge1xuICAgICAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgY29ubmVjdGlvbiB1bmhlYWx0aHksIGF0dGVtcHRpbmcgdG8gcmVjb25uZWN0Li4uJyk7XG4gICAgICAgIGF3YWl0IGRhdGFiYXNlTWFuYWdlci5mb3JjZVJlY29ubmVjdCgpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiKCk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlclN1YmplY3RzKVxuICAgICAgICAud2hlcmUoZXEodXNlclN1YmplY3RzLnVzZXJJZCwgdXNlcklkKSlcbiAgICAgICAgLm9yZGVyQnkoZGVzYyh1c2VyU3ViamVjdHMuZGF0ZUFkZGVkKSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKGBSZXRyaWV2ZWQgJHtyZXN1bHQubGVuZ3RofSBzdWJqZWN0cyBmb3IgdXNlciAke3VzZXJJZH1gKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldFVzZXJTdWJqZWN0czonLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZXRyaWV2ZSB1c2VyIHN1YmplY3RzIGZyb20gZGF0YWJhc2UnKTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBhZGRVc2VyU3ViamVjdCh1c2VyU3ViamVjdDogSW5zZXJ0VXNlclN1YmplY3QpOiBQcm9taXNlPFVzZXJTdWJqZWN0PiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3N1YmplY3RdID0gYXdhaXQgZGJcbiAgICAgICAgLmluc2VydCh1c2VyU3ViamVjdHMpXG4gICAgICAgIC52YWx1ZXModXNlclN1YmplY3QpXG4gICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgIHJldHVybiBzdWJqZWN0O1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgcmVtb3ZlVXNlclN1YmplY3QodXNlcklkOiBudW1iZXIsIHN1YmplY3RJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgYXdhaXQgZGJcbiAgICAgICAgLmRlbGV0ZSh1c2VyU3ViamVjdHMpXG4gICAgICAgIC53aGVyZShhbmQoXG4gICAgICAgICAgZXEodXNlclN1YmplY3RzLnVzZXJJZCwgdXNlcklkKSxcbiAgICAgICAgICBlcSh1c2VyU3ViamVjdHMuc3ViamVjdElkLCBzdWJqZWN0SWQpXG4gICAgICAgICkpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgaGFzVXNlclN1YmplY3QodXNlcklkOiBudW1iZXIsIHN1YmplY3RJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlclN1YmplY3RzKVxuICAgICAgICAud2hlcmUoYW5kKFxuICAgICAgICAgIGVxKHVzZXJTdWJqZWN0cy51c2VySWQsIHVzZXJJZCksXG4gICAgICAgICAgZXEodXNlclN1YmplY3RzLnN1YmplY3RJZCwgc3ViamVjdElkKVxuICAgICAgICApKTtcbiAgICAgIHJldHVybiAhIXJlc3VsdDtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHVwZGF0ZVN1YmplY3RNYXN0ZXJ5TGV2ZWwodXNlcklkOiBudW1iZXIsIHN1YmplY3RJZDogc3RyaW5nLCBtYXN0ZXJ5TGV2ZWw6IG51bWJlcik6IFByb21pc2U8VXNlclN1YmplY3QgfCBudWxsPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBlbnN1cmVEYXRhYmFzZUhlYWx0aCgpO1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3VwZGF0ZWRTdWJqZWN0XSA9IGF3YWl0IGRiXG4gICAgICAgIC51cGRhdGUodXNlclN1YmplY3RzKVxuICAgICAgICAuc2V0KHsgbWFzdGVyeUxldmVsIH0pXG4gICAgICAgIC53aGVyZShhbmQoXG4gICAgICAgICAgZXEodXNlclN1YmplY3RzLnVzZXJJZCwgdXNlcklkKSxcbiAgICAgICAgICBlcSh1c2VyU3ViamVjdHMuc3ViamVjdElkLCBzdWJqZWN0SWQpXG4gICAgICAgICkpXG4gICAgICAgIC5yZXR1cm5pbmcoKTtcbiAgICAgIHJldHVybiB1cGRhdGVkU3ViamVjdCB8fCBudWxsO1xuICAgIH0pO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBzdG9yYWdlID0gbmV3IERhdGFiYXNlU3RvcmFnZSgpOyJdLCJuYW1lcyI6WyJ1c2VycyIsIndhaXRsaXN0RW1haWxzIiwidXNlclN1YmplY3RzIiwiZ2V0RGIiLCJkYXRhYmFzZU1hbmFnZXIiLCJlcSIsImFuZCIsImRlc2MiLCJEYXRhYmFzZVJldHJ5SGFuZGxlciIsImVuc3VyZURhdGFiYXNlSGVhbHRoIiwiRGF0YWJhc2VTdG9yYWdlIiwiZ2V0VXNlciIsImlkIiwid2l0aFJldHJ5IiwiZGIiLCJ1c2VyIiwic2VsZWN0IiwiZnJvbSIsIndoZXJlIiwidW5kZWZpbmVkIiwiZ2V0VXNlckJ5VXNlcm5hbWUiLCJ1c2VybmFtZSIsImNyZWF0ZVVzZXIiLCJpbnNlcnRVc2VyIiwiaW5zZXJ0IiwidmFsdWVzIiwicmV0dXJuaW5nIiwiYWRkVG9XYWl0bGlzdCIsImluc2VydEVtYWlsIiwid2FpdGxpc3RFbWFpbCIsImVycm9yIiwiY29kZSIsIkVycm9yIiwiZ2V0V2FpdGxpc3RFbWFpbHMiLCJpc0VtYWlsSW5XYWl0bGlzdCIsImVtYWlsIiwicmVzdWx0IiwiZ2V0VXNlclN1YmplY3RzIiwidXNlcklkIiwiaXNIZWFsdGh5IiwiaGVhbHRoQ2hlY2siLCJjb25zb2xlIiwibG9nIiwiZm9yY2VSZWNvbm5lY3QiLCJvcmRlckJ5IiwiZGF0ZUFkZGVkIiwibGVuZ3RoIiwiYWRkVXNlclN1YmplY3QiLCJ1c2VyU3ViamVjdCIsInN1YmplY3QiLCJyZW1vdmVVc2VyU3ViamVjdCIsInN1YmplY3RJZCIsImRlbGV0ZSIsImhhc1VzZXJTdWJqZWN0IiwidXBkYXRlU3ViamVjdE1hc3RlcnlMZXZlbCIsIm1hc3RlcnlMZXZlbCIsInVwZGF0ZWRTdWJqZWN0IiwidXBkYXRlIiwic2V0Iiwic3RvcmFnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./server/storage.ts\n");

/***/ }),

/***/ "(api)/./shared/schema.ts":
/*!**************************!*\
  !*** ./shared/schema.ts ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   insertUserSchema: () => (/* binding */ insertUserSchema),\n/* harmony export */   insertUserSubjectSchema: () => (/* binding */ insertUserSubjectSchema),\n/* harmony export */   insertWaitlistEmailSchema: () => (/* binding */ insertWaitlistEmailSchema),\n/* harmony export */   userSubjects: () => (/* binding */ userSubjects),\n/* harmony export */   users: () => (/* binding */ users),\n/* harmony export */   waitlistEmails: () => (/* binding */ waitlistEmails)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"drizzle-orm/pg-core\");\n/* harmony import */ var drizzle_zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-zod */ \"drizzle-zod\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__, drizzle_zod__WEBPACK_IMPORTED_MODULE_1__]);\n([drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__, drizzle_zod__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\nconst users = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"users\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.serial)(\"id\").primaryKey(),\n    username: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"username\").notNull().unique(),\n    password: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"password\").notNull()\n});\nconst waitlistEmails = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"waitlist_emails\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.serial)(\"id\").primaryKey(),\n    email: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"email\").notNull().unique(),\n    signedUpAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.timestamp)(\"signed_up_at\").defaultNow().notNull()\n});\nconst userSubjects = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"user_subjects\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.serial)(\"id\").primaryKey(),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"user_id\").notNull().references(()=>users.id),\n    subjectId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"subject_id\").notNull(),\n    name: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"name\").notNull(),\n    description: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"description\").notNull(),\n    units: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"units\").notNull(),\n    difficulty: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"difficulty\").notNull(),\n    examDate: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"exam_date\").notNull(),\n    progress: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"progress\").default(0).notNull(),\n    masteryLevel: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"mastery_level\").default(4).notNull(),\n    lastStudied: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.timestamp)(\"last_studied\"),\n    dateAdded: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.timestamp)(\"date_added\").defaultNow().notNull()\n});\nconst insertUserSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_1__.createInsertSchema)(users).pick({\n    username: true,\n    password: true\n});\nconst insertWaitlistEmailSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_1__.createInsertSchema)(waitlistEmails).pick({\n    email: true\n});\nconst insertUserSubjectSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_1__.createInsertSchema)(userSubjects).omit({\n    id: true,\n    dateAdded: true\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zaGFyZWQvc2NoZW1hLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXlGO0FBQ3hDO0FBRzFDLE1BQU1NLFFBQVFOLDREQUFPQSxDQUFDLFNBQVM7SUFDcENPLElBQUlMLDJEQUFNQSxDQUFDLE1BQU1NLFVBQVU7SUFDM0JDLFVBQVVSLHlEQUFJQSxDQUFDLFlBQVlTLE9BQU8sR0FBR0MsTUFBTTtJQUMzQ0MsVUFBVVgseURBQUlBLENBQUMsWUFBWVMsT0FBTztBQUNwQyxHQUFHO0FBRUksTUFBTUcsaUJBQWlCYiw0REFBT0EsQ0FBQyxtQkFBbUI7SUFDdkRPLElBQUlMLDJEQUFNQSxDQUFDLE1BQU1NLFVBQVU7SUFDM0JNLE9BQU9iLHlEQUFJQSxDQUFDLFNBQVNTLE9BQU8sR0FBR0MsTUFBTTtJQUNyQ0ksWUFBWVgsOERBQVNBLENBQUMsZ0JBQWdCWSxVQUFVLEdBQUdOLE9BQU87QUFDNUQsR0FBRztBQUVJLE1BQU1PLGVBQWVqQiw0REFBT0EsQ0FBQyxpQkFBaUI7SUFDbkRPLElBQUlMLDJEQUFNQSxDQUFDLE1BQU1NLFVBQVU7SUFDM0JVLFFBQVFmLDREQUFPQSxDQUFDLFdBQVdPLE9BQU8sR0FBR1MsVUFBVSxDQUFDLElBQU1iLE1BQU1DLEVBQUU7SUFDOURhLFdBQVduQix5REFBSUEsQ0FBQyxjQUFjUyxPQUFPO0lBQ3JDVyxNQUFNcEIseURBQUlBLENBQUMsUUFBUVMsT0FBTztJQUMxQlksYUFBYXJCLHlEQUFJQSxDQUFDLGVBQWVTLE9BQU87SUFDeENhLE9BQU9wQiw0REFBT0EsQ0FBQyxTQUFTTyxPQUFPO0lBQy9CYyxZQUFZdkIseURBQUlBLENBQUMsY0FBY1MsT0FBTztJQUN0Q2UsVUFBVXhCLHlEQUFJQSxDQUFDLGFBQWFTLE9BQU87SUFDbkNnQixVQUFVdkIsNERBQU9BLENBQUMsWUFBWXdCLE9BQU8sQ0FBQyxHQUFHakIsT0FBTztJQUNoRGtCLGNBQWN6Qiw0REFBT0EsQ0FBQyxpQkFBaUJ3QixPQUFPLENBQUMsR0FBR2pCLE9BQU87SUFDekRtQixhQUFhekIsOERBQVNBLENBQUM7SUFDdkIwQixXQUFXMUIsOERBQVNBLENBQUMsY0FBY1ksVUFBVSxHQUFHTixPQUFPO0FBQ3pELEdBQUc7QUFFSSxNQUFNcUIsbUJBQW1CMUIsK0RBQWtCQSxDQUFDQyxPQUFPMEIsSUFBSSxDQUFDO0lBQzdEdkIsVUFBVTtJQUNWRyxVQUFVO0FBQ1osR0FBRztBQUVJLE1BQU1xQiw0QkFBNEI1QiwrREFBa0JBLENBQUNRLGdCQUFnQm1CLElBQUksQ0FBQztJQUMvRWxCLE9BQU87QUFDVCxHQUFHO0FBRUksTUFBTW9CLDBCQUEwQjdCLCtEQUFrQkEsQ0FBQ1ksY0FBY2tCLElBQUksQ0FBQztJQUMzRTVCLElBQUk7SUFDSnVCLFdBQVc7QUFDYixHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vc2hhcmVkL3NjaGVtYS50cz8xYjQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBnVGFibGUsIHRleHQsIHNlcmlhbCwgaW50ZWdlciwgYm9vbGVhbiwgdGltZXN0YW1wIH0gZnJvbSBcImRyaXp6bGUtb3JtL3BnLWNvcmVcIjtcbmltcG9ydCB7IGNyZWF0ZUluc2VydFNjaGVtYSB9IGZyb20gXCJkcml6emxlLXpvZFwiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcblxuZXhwb3J0IGNvbnN0IHVzZXJzID0gcGdUYWJsZShcInVzZXJzXCIsIHtcbiAgaWQ6IHNlcmlhbChcImlkXCIpLnByaW1hcnlLZXkoKSxcbiAgdXNlcm5hbWU6IHRleHQoXCJ1c2VybmFtZVwiKS5ub3ROdWxsKCkudW5pcXVlKCksXG4gIHBhc3N3b3JkOiB0ZXh0KFwicGFzc3dvcmRcIikubm90TnVsbCgpLFxufSk7XG5cbmV4cG9ydCBjb25zdCB3YWl0bGlzdEVtYWlscyA9IHBnVGFibGUoXCJ3YWl0bGlzdF9lbWFpbHNcIiwge1xuICBpZDogc2VyaWFsKFwiaWRcIikucHJpbWFyeUtleSgpLFxuICBlbWFpbDogdGV4dChcImVtYWlsXCIpLm5vdE51bGwoKS51bmlxdWUoKSxcbiAgc2lnbmVkVXBBdDogdGltZXN0YW1wKFwic2lnbmVkX3VwX2F0XCIpLmRlZmF1bHROb3coKS5ub3ROdWxsKCksXG59KTtcblxuZXhwb3J0IGNvbnN0IHVzZXJTdWJqZWN0cyA9IHBnVGFibGUoXCJ1c2VyX3N1YmplY3RzXCIsIHtcbiAgaWQ6IHNlcmlhbChcImlkXCIpLnByaW1hcnlLZXkoKSxcbiAgdXNlcklkOiBpbnRlZ2VyKFwidXNlcl9pZFwiKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB1c2Vycy5pZCksXG4gIHN1YmplY3RJZDogdGV4dChcInN1YmplY3RfaWRcIikubm90TnVsbCgpLFxuICBuYW1lOiB0ZXh0KFwibmFtZVwiKS5ub3ROdWxsKCksXG4gIGRlc2NyaXB0aW9uOiB0ZXh0KFwiZGVzY3JpcHRpb25cIikubm90TnVsbCgpLFxuICB1bml0czogaW50ZWdlcihcInVuaXRzXCIpLm5vdE51bGwoKSxcbiAgZGlmZmljdWx0eTogdGV4dChcImRpZmZpY3VsdHlcIikubm90TnVsbCgpLFxuICBleGFtRGF0ZTogdGV4dChcImV4YW1fZGF0ZVwiKS5ub3ROdWxsKCksXG4gIHByb2dyZXNzOiBpbnRlZ2VyKFwicHJvZ3Jlc3NcIikuZGVmYXVsdCgwKS5ub3ROdWxsKCksXG4gIG1hc3RlcnlMZXZlbDogaW50ZWdlcihcIm1hc3RlcnlfbGV2ZWxcIikuZGVmYXVsdCg0KS5ub3ROdWxsKCksIC8vIEFQIHRlc3QgZ29hbDogMywgNCwgb3IgNVxuICBsYXN0U3R1ZGllZDogdGltZXN0YW1wKFwibGFzdF9zdHVkaWVkXCIpLFxuICBkYXRlQWRkZWQ6IHRpbWVzdGFtcChcImRhdGVfYWRkZWRcIikuZGVmYXVsdE5vdygpLm5vdE51bGwoKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0VXNlclNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYSh1c2VycykucGljayh7XG4gIHVzZXJuYW1lOiB0cnVlLFxuICBwYXNzd29yZDogdHJ1ZSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0V2FpdGxpc3RFbWFpbFNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYSh3YWl0bGlzdEVtYWlscykucGljayh7XG4gIGVtYWlsOiB0cnVlLFxufSk7XG5cbmV4cG9ydCBjb25zdCBpbnNlcnRVc2VyU3ViamVjdFNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYSh1c2VyU3ViamVjdHMpLm9taXQoe1xuICBpZDogdHJ1ZSxcbiAgZGF0ZUFkZGVkOiB0cnVlLFxufSk7XG5cbmV4cG9ydCB0eXBlIEluc2VydFVzZXIgPSB6LmluZmVyPHR5cGVvZiBpbnNlcnRVc2VyU2NoZW1hPjtcbmV4cG9ydCB0eXBlIFVzZXIgPSB0eXBlb2YgdXNlcnMuJGluZmVyU2VsZWN0O1xuZXhwb3J0IHR5cGUgSW5zZXJ0V2FpdGxpc3RFbWFpbCA9IHouaW5mZXI8dHlwZW9mIGluc2VydFdhaXRsaXN0RW1haWxTY2hlbWE+O1xuZXhwb3J0IHR5cGUgV2FpdGxpc3RFbWFpbCA9IHR5cGVvZiB3YWl0bGlzdEVtYWlscy4kaW5mZXJTZWxlY3Q7XG5leHBvcnQgdHlwZSBJbnNlcnRVc2VyU3ViamVjdCA9IHouaW5mZXI8dHlwZW9mIGluc2VydFVzZXJTdWJqZWN0U2NoZW1hPjtcbmV4cG9ydCB0eXBlIFVzZXJTdWJqZWN0ID0gdHlwZW9mIHVzZXJTdWJqZWN0cy4kaW5mZXJTZWxlY3Q7XG4iXSwibmFtZXMiOlsicGdUYWJsZSIsInRleHQiLCJzZXJpYWwiLCJpbnRlZ2VyIiwidGltZXN0YW1wIiwiY3JlYXRlSW5zZXJ0U2NoZW1hIiwidXNlcnMiLCJpZCIsInByaW1hcnlLZXkiLCJ1c2VybmFtZSIsIm5vdE51bGwiLCJ1bmlxdWUiLCJwYXNzd29yZCIsIndhaXRsaXN0RW1haWxzIiwiZW1haWwiLCJzaWduZWRVcEF0IiwiZGVmYXVsdE5vdyIsInVzZXJTdWJqZWN0cyIsInVzZXJJZCIsInJlZmVyZW5jZXMiLCJzdWJqZWN0SWQiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJ1bml0cyIsImRpZmZpY3VsdHkiLCJleGFtRGF0ZSIsInByb2dyZXNzIiwiZGVmYXVsdCIsIm1hc3RlcnlMZXZlbCIsImxhc3RTdHVkaWVkIiwiZGF0ZUFkZGVkIiwiaW5zZXJ0VXNlclNjaGVtYSIsInBpY2siLCJpbnNlcnRXYWl0bGlzdEVtYWlsU2NoZW1hIiwiaW5zZXJ0VXNlclN1YmplY3RTY2hlbWEiLCJvbWl0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./shared/schema.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();