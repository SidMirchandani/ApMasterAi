"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/user/subjects";
exports.ids = ["pages/api/user/subjects"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "@neondatabase/serverless":
/*!*******************************************!*\
  !*** external "@neondatabase/serverless" ***!
  \*******************************************/
/***/ ((module) => {

module.exports = import("@neondatabase/serverless");;

/***/ }),

/***/ "drizzle-orm":
/*!******************************!*\
  !*** external "drizzle-orm" ***!
  \******************************/
/***/ ((module) => {

module.exports = import("drizzle-orm");;

/***/ }),

/***/ "drizzle-orm/neon-serverless":
/*!**********************************************!*\
  !*** external "drizzle-orm/neon-serverless" ***!
  \**********************************************/
/***/ ((module) => {

module.exports = import("drizzle-orm/neon-serverless");;

/***/ }),

/***/ "drizzle-orm/pg-core":
/*!**************************************!*\
  !*** external "drizzle-orm/pg-core" ***!
  \**************************************/
/***/ ((module) => {

module.exports = import("drizzle-orm/pg-core");;

/***/ }),

/***/ "drizzle-zod":
/*!******************************!*\
  !*** external "drizzle-zod" ***!
  \******************************/
/***/ ((module) => {

module.exports = import("drizzle-zod");;

/***/ }),

/***/ "ws":
/*!*********************!*\
  !*** external "ws" ***!
  \*********************/
/***/ ((module) => {

module.exports = import("ws");;

/***/ }),

/***/ "zod":
/*!**********************!*\
  !*** external "zod" ***!
  \**********************/
/***/ ((module) => {

module.exports = import("zod");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/user/subjects.ts */ \"(api)/./pages/api/user/subjects.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/user/subjects\",\n        pathname: \"/api/user/subjects\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_user_subjects_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVzZXIlMkZzdWJqZWN0cyZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGdXNlciUyRnN1YmplY3RzLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3lEO0FBQ3pEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyx3REFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsd0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLz8zNGQyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvdXNlci9zdWJqZWN0cy50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3VzZXIvc3ViamVjdHNcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS91c2VyL3N1YmplY3RzXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/user/subjects.ts":
/*!************************************!*\
  !*** ./pages/api/user/subjects.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _server_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../server/storage */ \"(api)/./server/storage.ts\");\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @shared/schema */ \"(api)/./shared/schema.ts\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"zod\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_server_storage__WEBPACK_IMPORTED_MODULE_0__, _shared_schema__WEBPACK_IMPORTED_MODULE_1__, zod__WEBPACK_IMPORTED_MODULE_2__]);\n([_server_storage__WEBPACK_IMPORTED_MODULE_0__, _shared_schema__WEBPACK_IMPORTED_MODULE_1__, zod__WEBPACK_IMPORTED_MODULE_2__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\nasync function getOrCreateUser(firebaseUid) {\n    let user = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.getUserByUsername(firebaseUid);\n    if (!user) {\n        user = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.createUser({\n            username: firebaseUid,\n            password: \"firebase_auth\"\n        });\n        console.log(\"[subjects API] Created new user for Firebase UID:\", firebaseUid);\n    }\n    return user.id;\n}\nasync function handler(req, res) {\n    const { method } = req;\n    const firebaseUid = req.headers[\"x-user-id\"];\n    if (!firebaseUid) {\n        return res.status(401).json({\n            success: false,\n            message: \"Authentication required\"\n        });\n    }\n    try {\n        const userId = await getOrCreateUser(firebaseUid);\n        switch(method){\n            case \"GET\":\n                {\n                    try {\n                        const subjects = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.getUserSubjects(userId);\n                        res.setHeader(\"Cache-Control\", \"public, s-maxage=60, stale-while-revalidate=300\");\n                        return res.json({\n                            success: true,\n                            data: subjects\n                        });\n                    } catch (error) {\n                        console.error(\"[subjects API][GET] Error:\", error);\n                        return res.status(500).json({\n                            success: false,\n                            message: \"Failed to load subjects from database\"\n                        });\n                    }\n                }\n            case \"POST\":\n                {\n                    try {\n                        const hasSubject = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.hasUserSubject(userId, req.body.subjectId);\n                        if (hasSubject) {\n                            return res.status(409).json({\n                                success: false,\n                                message: \"Subject already added to dashboard\"\n                            });\n                        }\n                        const validatedData = _shared_schema__WEBPACK_IMPORTED_MODULE_1__.insertUserSubjectSchema.parse({\n                            ...req.body,\n                            userId\n                        });\n                        const subject = await _server_storage__WEBPACK_IMPORTED_MODULE_0__.storage.addUserSubject(validatedData);\n                        return res.json({\n                            success: true,\n                            message: \"Subject added to dashboard!\",\n                            data: subject\n                        });\n                    } catch (error) {\n                        console.error(\"[subjects API][POST] Error:\", error);\n                        if (error instanceof zod__WEBPACK_IMPORTED_MODULE_2__.z.ZodError) {\n                            return res.status(400).json({\n                                success: false,\n                                message: \"Invalid subject data\",\n                                errors: error.errors\n                            });\n                        }\n                        return res.status(500).json({\n                            success: false,\n                            message: \"Failed to add subject to database\"\n                        });\n                    }\n                }\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\"\n                ]);\n                return res.status(405).json({\n                    success: false,\n                    message: `Method ${method} not allowed`\n                });\n        }\n    } catch (error) {\n        console.error(`[subjects API][${req.method}] Unhandled error:`, error);\n        return res.status(500).json({\n            success: false,\n            message: \"Internal server error\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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aUIsS0FBSyxDQUFDLENBQUMsZUFBZSxFQUFFYixJQUFJRSxNQUFNLENBQUMsa0JBQWtCLENBQUMsRUFBRVc7UUFDaEUsT0FBT1osSUFBSUcsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUMxQkMsU0FBUztZQUNUQyxTQUFTO1FBQ1g7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vcGFnZXMvYXBpL3VzZXIvc3ViamVjdHMudHM/ZjFiMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tIFwibmV4dFwiO1xuaW1wb3J0IHsgc3RvcmFnZSB9IGZyb20gXCIuLi8uLi8uLi9zZXJ2ZXIvc3RvcmFnZVwiO1xuaW1wb3J0IHsgaW5zZXJ0VXNlclN1YmplY3RTY2hlbWEgfSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5cbmFzeW5jIGZ1bmN0aW9uIGdldE9yQ3JlYXRlVXNlcihmaXJlYmFzZVVpZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgbGV0IHVzZXIgPSBhd2FpdCBzdG9yYWdlLmdldFVzZXJCeVVzZXJuYW1lKGZpcmViYXNlVWlkKTtcblxuICBpZiAoIXVzZXIpIHtcbiAgICB1c2VyID0gYXdhaXQgc3RvcmFnZS5jcmVhdGVVc2VyKHtcbiAgICAgIHVzZXJuYW1lOiBmaXJlYmFzZVVpZCxcbiAgICAgIHBhc3N3b3JkOiBcImZpcmViYXNlX2F1dGhcIiwgLy8gcGxhY2Vob2xkZXIgc2luY2UgRmlyZWJhc2UgaGFuZGxlcyBhdXRoXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2coXG4gICAgICBcIltzdWJqZWN0cyBBUEldIENyZWF0ZWQgbmV3IHVzZXIgZm9yIEZpcmViYXNlIFVJRDpcIixcbiAgICAgIGZpcmViYXNlVWlkLFxuICAgICk7XG4gIH1cblxuICByZXR1cm4gdXNlci5pZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcbiAgcmVzOiBOZXh0QXBpUmVzcG9uc2UsXG4pIHtcbiAgY29uc3QgeyBtZXRob2QgfSA9IHJlcTtcbiAgY29uc3QgZmlyZWJhc2VVaWQgPSByZXEuaGVhZGVyc1tcIngtdXNlci1pZFwiXSBhcyBzdHJpbmc7XG5cbiAgaWYgKCFmaXJlYmFzZVVpZCkge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6IFwiQXV0aGVudGljYXRpb24gcmVxdWlyZWRcIixcbiAgICB9KTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc3QgdXNlcklkID0gYXdhaXQgZ2V0T3JDcmVhdGVVc2VyKGZpcmViYXNlVWlkKTtcblxuICAgIHN3aXRjaCAobWV0aG9kKSB7XG4gICAgICBjYXNlIFwiR0VUXCI6IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBzdWJqZWN0cyA9IGF3YWl0IHN0b3JhZ2UuZ2V0VXNlclN1YmplY3RzKHVzZXJJZCk7XG4gICAgICAgICAgcmVzLnNldEhlYWRlcihcbiAgICAgICAgICAgIFwiQ2FjaGUtQ29udHJvbFwiLFxuICAgICAgICAgICAgXCJwdWJsaWMsIHMtbWF4YWdlPTYwLCBzdGFsZS13aGlsZS1yZXZhbGlkYXRlPTMwMFwiLFxuICAgICAgICAgICk7XG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogc3ViamVjdHMgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIltzdWJqZWN0cyBBUEldW0dFVF0gRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBsb2FkIHN1YmplY3RzIGZyb20gZGF0YWJhc2VcIixcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBjYXNlIFwiUE9TVFwiOiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgaGFzU3ViamVjdCA9IGF3YWl0IHN0b3JhZ2UuaGFzVXNlclN1YmplY3QoXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICByZXEuYm9keS5zdWJqZWN0SWQsXG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAoaGFzU3ViamVjdCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA5KS5qc29uKHtcbiAgICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IFwiU3ViamVjdCBhbHJlYWR5IGFkZGVkIHRvIGRhc2hib2FyZFwiLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgdmFsaWRhdGVkRGF0YSA9IGluc2VydFVzZXJTdWJqZWN0U2NoZW1hLnBhcnNlKHtcbiAgICAgICAgICAgIC4uLnJlcS5ib2R5LFxuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3Qgc3ViamVjdCA9IGF3YWl0IHN0b3JhZ2UuYWRkVXNlclN1YmplY3QodmFsaWRhdGVkRGF0YSk7XG5cbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oe1xuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiU3ViamVjdCBhZGRlZCB0byBkYXNoYm9hcmQhXCIsXG4gICAgICAgICAgICBkYXRhOiBzdWJqZWN0LFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJbc3ViamVjdHMgQVBJXVtQT1NUXSBFcnJvcjpcIiwgZXJyb3IpO1xuICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIHouWm9kRXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgc3ViamVjdCBkYXRhXCIsXG4gICAgICAgICAgICAgIGVycm9yczogZXJyb3IuZXJyb3JzLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGFkZCBzdWJqZWN0IHRvIGRhdGFiYXNlXCIsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmVzLnNldEhlYWRlcihcIkFsbG93XCIsIFtcIkdFVFwiLCBcIlBPU1RcIl0pO1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIG1lc3NhZ2U6IGBNZXRob2QgJHttZXRob2R9IG5vdCBhbGxvd2VkYCxcbiAgICAgICAgfSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYFtzdWJqZWN0cyBBUEldWyR7cmVxLm1ldGhvZH1dIFVuaGFuZGxlZCBlcnJvcjpgLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgbWVzc2FnZTogXCJJbnRlcm5hbCBzZXJ2ZXIgZXJyb3JcIixcbiAgICB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInN0b3JhZ2UiLCJpbnNlcnRVc2VyU3ViamVjdFNjaGVtYSIsInoiLCJnZXRPckNyZWF0ZVVzZXIiLCJmaXJlYmFzZVVpZCIsInVzZXIiLCJnZXRVc2VyQnlVc2VybmFtZSIsImNyZWF0ZVVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiY29uc29sZSIsImxvZyIsImlkIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsImhlYWRlcnMiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJ1c2VySWQiLCJzdWJqZWN0cyIsImdldFVzZXJTdWJqZWN0cyIsInNldEhlYWRlciIsImRhdGEiLCJlcnJvciIsImhhc1N1YmplY3QiLCJoYXNVc2VyU3ViamVjdCIsImJvZHkiLCJzdWJqZWN0SWQiLCJ2YWxpZGF0ZWREYXRhIiwicGFyc2UiLCJzdWJqZWN0IiwiYWRkVXNlclN1YmplY3QiLCJab2RFcnJvciIsImVycm9ycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/user/subjects.ts\n");

/***/ }),

/***/ "(api)/./server/db-retry-handler.ts":
/*!************************************!*\
  !*** ./server/db-retry-handler.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseRetryHandler: () => (/* binding */ DatabaseRetryHandler),\n/* harmony export */   ensureDatabaseHealth: () => (/* binding */ ensureDatabaseHealth)\n/* harmony export */ });\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./db */ \"(api)/./server/db.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_db__WEBPACK_IMPORTED_MODULE_0__]);\n_db__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n/**\n * Provides retry and resilience mechanisms for database operations\n */ class DatabaseRetryHandler {\n    static{\n        this.DEFAULT_MAX_RETRIES = 3;\n    }\n    static{\n        this.DEFAULT_BACKOFF_MS = 1000;\n    }\n    /**\n   * Run an operation with retry logic and exponential backoff\n   */ static async withRetry(operation, maxRetries = this.DEFAULT_MAX_RETRIES, backoffMs = this.DEFAULT_BACKOFF_MS) {\n        let lastError = null;\n        for(let attempt = 1; attempt <= maxRetries + 1; attempt++){\n            try {\n                // Ensure DB health before executing\n                const isHealthy = await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.healthCheck();\n                if (!isHealthy && attempt === 1) {\n                    console.warn(\"Database unhealthy on first attempt, forcing reconnect...\");\n                    await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.forceReconnect();\n                }\n                return await operation();\n            } catch (err) {\n                lastError = err instanceof Error ? err : new Error(String(err));\n                console.warn(`Database operation failed (attempt ${attempt}/${maxRetries + 1}):`, lastError.message);\n                if (attempt > maxRetries) break;\n                if (this.isConnectionError(lastError)) {\n                    console.log(\"Connection error detected, forcing reconnection...\");\n                    try {\n                        await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.forceReconnect();\n                    } catch (reconnectError) {\n                        console.error(\"Reconnection failed:\", reconnectError);\n                    }\n                }\n                // Backoff with jitter\n                const delay = backoffMs * Math.pow(2, attempt - 1) + Math.random() * 1000;\n                await new Promise((resolve)=>setTimeout(resolve, Math.min(delay, 30000)));\n            }\n        }\n        throw lastError || new Error(\"Database operation failed after retries\");\n    }\n    /**\n   * Check whether error looks like a connection issue\n   */ static isConnectionError(error) {\n        const patterns = [\n            /connection/i,\n            /network/i,\n            /timeout/i,\n            /ECONNRESET/i,\n            /ENOTFOUND/i,\n            /ETIMEDOUT/i,\n            /socket/i,\n            /pool/i\n        ];\n        return patterns.some((pattern)=>pattern.test(error.message) || pattern.test(error.name));\n    }\n    /**\n   * Run a transaction with retry logic\n   */ static async withTransaction(operation, maxRetries = 2) {\n        return this.withRetry(async ()=>{\n            const db = await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.getDatabase();\n            return db.transaction(operation);\n        }, maxRetries);\n    }\n    /**\n   * Perform a health check and try recovery if needed\n   */ static async healthCheckWithRecovery() {\n        try {\n            let isHealthy = await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.healthCheck();\n            if (!isHealthy) {\n                console.log(\"Health check failed, forcing recovery...\");\n                await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.forceReconnect();\n                isHealthy = await _db__WEBPACK_IMPORTED_MODULE_0__.databaseManager.healthCheck();\n            }\n            return isHealthy;\n        } catch (error) {\n            console.error(\"Health check with recovery failed:\", error);\n            return false;\n        }\n    }\n}\n/**\n * Middleware helper to enforce DB health\n */ async function ensureDatabaseHealth() {\n    const isHealthy = await DatabaseRetryHandler.healthCheckWithRecovery();\n    if (!isHealthy) {\n        throw new Error(\"Database is not available after recovery attempts\");\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxJQUFJLENBQUM5QixXQUFXO1FBQ2QsTUFBTSxJQUFJTSxNQUFNO0lBQ2xCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZXN0LWV4cHJlc3MvLi9zZXJ2ZXIvZGItcmV0cnktaGFuZGxlci50cz9lZTZlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRhdGFiYXNlTWFuYWdlciB9IGZyb20gXCIuL2RiXCI7XG5pbXBvcnQgdHlwZSB7IE5lb25EYXRhYmFzZSB9IGZyb20gXCJkcml6emxlLW9ybS9uZW9uLXNlcnZlcmxlc3NcIjtcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcblxuLyoqXG4gKiBQcm92aWRlcyByZXRyeSBhbmQgcmVzaWxpZW5jZSBtZWNoYW5pc21zIGZvciBkYXRhYmFzZSBvcGVyYXRpb25zXG4gKi9cbmV4cG9ydCBjbGFzcyBEYXRhYmFzZVJldHJ5SGFuZGxlciB7XG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IERFRkFVTFRfTUFYX1JFVFJJRVMgPSAzO1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBERUZBVUxUX0JBQ0tPRkZfTVMgPSAxMDAwO1xuXG4gIC8qKlxuICAgKiBSdW4gYW4gb3BlcmF0aW9uIHdpdGggcmV0cnkgbG9naWMgYW5kIGV4cG9uZW50aWFsIGJhY2tvZmZcbiAgICovXG4gIHN0YXRpYyBhc3luYyB3aXRoUmV0cnk8VD4oXG4gICAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxuICAgIG1heFJldHJpZXMgPSB0aGlzLkRFRkFVTFRfTUFYX1JFVFJJRVMsXG4gICAgYmFja29mZk1zID0gdGhpcy5ERUZBVUxUX0JBQ0tPRkZfTVMsXG4gICk6IFByb21pc2U8VD4ge1xuICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGw7XG5cbiAgICBmb3IgKGxldCBhdHRlbXB0ID0gMTsgYXR0ZW1wdCA8PSBtYXhSZXRyaWVzICsgMTsgYXR0ZW1wdCsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICAvLyBFbnN1cmUgREIgaGVhbHRoIGJlZm9yZSBleGVjdXRpbmdcbiAgICAgICAgY29uc3QgaXNIZWFsdGh5ID0gYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmhlYWx0aENoZWNrKCk7XG4gICAgICAgIGlmICghaXNIZWFsdGh5ICYmIGF0dGVtcHQgPT09IDEpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICBcIkRhdGFiYXNlIHVuaGVhbHRoeSBvbiBmaXJzdCBhdHRlbXB0LCBmb3JjaW5nIHJlY29ubmVjdC4uLlwiLFxuICAgICAgICAgICk7XG4gICAgICAgICAgYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmZvcmNlUmVjb25uZWN0KCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYXdhaXQgb3BlcmF0aW9uKCk7XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgbGFzdEVycm9yID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIgOiBuZXcgRXJyb3IoU3RyaW5nKGVycikpO1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYERhdGFiYXNlIG9wZXJhdGlvbiBmYWlsZWQgKGF0dGVtcHQgJHthdHRlbXB0fS8ke21heFJldHJpZXMgKyAxfSk6YCxcbiAgICAgICAgICBsYXN0RXJyb3IubWVzc2FnZSxcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoYXR0ZW1wdCA+IG1heFJldHJpZXMpIGJyZWFrO1xuXG4gICAgICAgIGlmICh0aGlzLmlzQ29ubmVjdGlvbkVycm9yKGxhc3RFcnJvcikpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkNvbm5lY3Rpb24gZXJyb3IgZGV0ZWN0ZWQsIGZvcmNpbmcgcmVjb25uZWN0aW9uLi4uXCIpO1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBkYXRhYmFzZU1hbmFnZXIuZm9yY2VSZWNvbm5lY3QoKTtcbiAgICAgICAgICB9IGNhdGNoIChyZWNvbm5lY3RFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIlJlY29ubmVjdGlvbiBmYWlsZWQ6XCIsIHJlY29ubmVjdEVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBCYWNrb2ZmIHdpdGggaml0dGVyXG4gICAgICAgIGNvbnN0IGRlbGF5ID1cbiAgICAgICAgICBiYWNrb2ZmTXMgKiBNYXRoLnBvdygyLCBhdHRlbXB0IC0gMSkgKyBNYXRoLnJhbmRvbSgpICogMTAwMDtcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpID0+XG4gICAgICAgICAgc2V0VGltZW91dChyZXNvbHZlLCBNYXRoLm1pbihkZWxheSwgMzAwMDApKSxcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aHJvdyBsYXN0RXJyb3IgfHwgbmV3IEVycm9yKFwiRGF0YWJhc2Ugb3BlcmF0aW9uIGZhaWxlZCBhZnRlciByZXRyaWVzXCIpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrIHdoZXRoZXIgZXJyb3IgbG9va3MgbGlrZSBhIGNvbm5lY3Rpb24gaXNzdWVcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGlzQ29ubmVjdGlvbkVycm9yKGVycm9yOiBFcnJvcik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IHBhdHRlcm5zID0gW1xuICAgICAgL2Nvbm5lY3Rpb24vaSxcbiAgICAgIC9uZXR3b3JrL2ksXG4gICAgICAvdGltZW91dC9pLFxuICAgICAgL0VDT05OUkVTRVQvaSxcbiAgICAgIC9FTk9URk9VTkQvaSxcbiAgICAgIC9FVElNRURPVVQvaSxcbiAgICAgIC9zb2NrZXQvaSxcbiAgICAgIC9wb29sL2ksXG4gICAgXTtcbiAgICByZXR1cm4gcGF0dGVybnMuc29tZShcbiAgICAgIChwYXR0ZXJuKSA9PiBwYXR0ZXJuLnRlc3QoZXJyb3IubWVzc2FnZSkgfHwgcGF0dGVybi50ZXN0KGVycm9yLm5hbWUpLFxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogUnVuIGEgdHJhbnNhY3Rpb24gd2l0aCByZXRyeSBsb2dpY1xuICAgKi9cbiAgc3RhdGljIGFzeW5jIHdpdGhUcmFuc2FjdGlvbjxUPihcbiAgICBvcGVyYXRpb246ICh0eDogTmVvbkRhdGFiYXNlPHR5cGVvZiBzY2hlbWE+KSA9PiBQcm9taXNlPFQ+LFxuICAgIG1heFJldHJpZXMgPSAyLFxuICApOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gdGhpcy53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBkYXRhYmFzZU1hbmFnZXIuZ2V0RGF0YWJhc2UoKTtcbiAgICAgIHJldHVybiBkYi50cmFuc2FjdGlvbihvcGVyYXRpb24pO1xuICAgIH0sIG1heFJldHJpZXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm0gYSBoZWFsdGggY2hlY2sgYW5kIHRyeSByZWNvdmVyeSBpZiBuZWVkZWRcbiAgICovXG4gIHN0YXRpYyBhc3luYyBoZWFsdGhDaGVja1dpdGhSZWNvdmVyeSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgbGV0IGlzSGVhbHRoeSA9IGF3YWl0IGRhdGFiYXNlTWFuYWdlci5oZWFsdGhDaGVjaygpO1xuICAgICAgaWYgKCFpc0hlYWx0aHkpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJIZWFsdGggY2hlY2sgZmFpbGVkLCBmb3JjaW5nIHJlY292ZXJ5Li4uXCIpO1xuICAgICAgICBhd2FpdCBkYXRhYmFzZU1hbmFnZXIuZm9yY2VSZWNvbm5lY3QoKTtcbiAgICAgICAgaXNIZWFsdGh5ID0gYXdhaXQgZGF0YWJhc2VNYW5hZ2VyLmhlYWx0aENoZWNrKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gaXNIZWFsdGh5O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiSGVhbHRoIGNoZWNrIHdpdGggcmVjb3ZlcnkgZmFpbGVkOlwiLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogTWlkZGxld2FyZSBoZWxwZXIgdG8gZW5mb3JjZSBEQiBoZWFsdGhcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGVuc3VyZURhdGFiYXNlSGVhbHRoKCk6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCBpc0hlYWx0aHkgPSBhd2FpdCBEYXRhYmFzZVJldHJ5SGFuZGxlci5oZWFsdGhDaGVja1dpdGhSZWNvdmVyeSgpO1xuICBpZiAoIWlzSGVhbHRoeSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkRhdGFiYXNlIGlzIG5vdCBhdmFpbGFibGUgYWZ0ZXIgcmVjb3ZlcnkgYXR0ZW1wdHNcIik7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJkYXRhYmFzZU1hbmFnZXIiLCJEYXRhYmFzZVJldHJ5SGFuZGxlciIsIkRFRkFVTFRfTUFYX1JFVFJJRVMiLCJERUZBVUxUX0JBQ0tPRkZfTVMiLCJ3aXRoUmV0cnkiLCJvcGVyYXRpb24iLCJtYXhSZXRyaWVzIiwiYmFja29mZk1zIiwibGFzdEVycm9yIiwiYXR0ZW1wdCIsImlzSGVhbHRoeSIsImhlYWx0aENoZWNrIiwiY29uc29sZSIsIndhcm4iLCJmb3JjZVJlY29ubmVjdCIsImVyciIsIkVycm9yIiwiU3RyaW5nIiwibWVzc2FnZSIsImlzQ29ubmVjdGlvbkVycm9yIiwibG9nIiwicmVjb25uZWN0RXJyb3IiLCJlcnJvciIsImRlbGF5IiwiTWF0aCIsInBvdyIsInJhbmRvbSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsIm1pbiIsInBhdHRlcm5zIiwic29tZSIsInBhdHRlcm4iLCJ0ZXN0IiwibmFtZSIsIndpdGhUcmFuc2FjdGlvbiIsImRiIiwiZ2V0RGF0YWJhc2UiLCJ0cmFuc2FjdGlvbiIsImhlYWx0aENoZWNrV2l0aFJlY292ZXJ5IiwiZW5zdXJlRGF0YWJhc2VIZWFsdGgiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./server/db-retry-handler.ts\n");

/***/ }),

/***/ "(api)/./server/db.ts":
/*!**********************!*\
  !*** ./server/db.ts ***!
  \**********************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   databaseManager: () => (/* binding */ databaseManager),\n/* harmony export */   getDb: () => (/* binding */ getDb),\n/* harmony export */   getPool: () => (/* binding */ getPool)\n/* harmony export */ });\n/* harmony import */ var _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @neondatabase/serverless */ \"@neondatabase/serverless\");\n/* harmony import */ var drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/neon-serverless */ \"drizzle-orm/neon-serverless\");\n/* harmony import */ var ws__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ws */ \"ws\");\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @shared/schema */ \"(api)/./shared/schema.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__, drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__, ws__WEBPACK_IMPORTED_MODULE_2__, _shared_schema__WEBPACK_IMPORTED_MODULE_3__]);\n([_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__, drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__, ws__WEBPACK_IMPORTED_MODULE_2__, _shared_schema__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n// Neon configuration for serverless Postgres\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.webSocketConstructor = ws__WEBPACK_IMPORTED_MODULE_2__[\"default\"];\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.useSecureWebSocket = true;\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.pipelineConnect = false;\n_neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.neonConfig.fetchConnectionCache = true;\nif (!process.env.DATABASE_URL) {\n    throw new Error(\"DATABASE_URL must be set. Did you forget to provision a database?\");\n}\n// Connection pool configuration\nconst poolConfig = {\n    connectionString: process.env.DATABASE_URL,\n    max: 10,\n    min: 2,\n    idleTimeoutMillis: 30000,\n    connectionTimeoutMillis: 10000,\n    maxUses: 7500,\n    keepAlive: true,\n    log: (msg, level)=>{\n        if (level === \"error\") {\n            console.error(\"Database pool error:\", msg);\n        } else if (true) {\n            console.log(\"Database pool:\", level, msg);\n        }\n    }\n};\nclass DatabaseManager {\n    constructor(){\n        this.pool = null;\n        this.db = null;\n        this.reconnectAttempts = 0;\n        this.maxReconnectAttempts = 5;\n        this.isReconnecting = false;\n    }\n    static getInstance() {\n        if (!DatabaseManager.instance) {\n            DatabaseManager.instance = new DatabaseManager();\n            DatabaseManager.instance.initializeConnection().catch((err)=>{\n                console.error(\"Failed to initialize database:\", err);\n            });\n        }\n        return DatabaseManager.instance;\n    }\n    async initializeConnection() {\n        try {\n            console.log(\"Initializing database connection...\");\n            this.pool = new _neondatabase_serverless__WEBPACK_IMPORTED_MODULE_0__.Pool(poolConfig);\n            // Test the connection\n            const client = await this.pool.connect();\n            await client.query(\"SELECT 1\");\n            client.release();\n            this.db = (0,drizzle_orm_neon_serverless__WEBPACK_IMPORTED_MODULE_1__.drizzle)(this.pool, {\n                schema: _shared_schema__WEBPACK_IMPORTED_MODULE_3__\n            });\n            this.reconnectAttempts = 0;\n            this.setupConnectionMonitoring();\n            console.log(\"Database connection established.\");\n        } catch (error) {\n            console.error(\"Failed to initialize database connection:\", error);\n            await this.handleConnectionError(error);\n        }\n    }\n    setupConnectionMonitoring() {\n        if (!this.pool) return;\n        this.pool.on(\"error\", async (err)=>{\n            console.error(\"Database pool error:\", err);\n            await this.handleConnectionError(err);\n        });\n    }\n    async handleConnectionError(error) {\n        if (this.isReconnecting) return;\n        console.error(\"Database connection error:\", error);\n        if (this.reconnectAttempts < this.maxReconnectAttempts) {\n            this.isReconnecting = true;\n            this.reconnectAttempts++;\n            const backoffMs = Math.min(1000 * Math.pow(2, this.reconnectAttempts - 1), 30000);\n            await new Promise((resolve)=>setTimeout(resolve, backoffMs));\n            try {\n                await this.closeConnection();\n                await this.initializeConnection();\n            } finally{\n                this.isReconnecting = false;\n            }\n        } else {\n            console.error(\"Max reconnection attempts reached.\");\n        }\n    }\n    async closeConnection() {\n        if (this.pool) {\n            await this.pool.end();\n            this.pool = null;\n            this.db = null;\n            console.log(\"Database connection closed\");\n        }\n    }\n    async getDatabase() {\n        if (!this.db) {\n            await this.initializeConnection();\n            if (!this.db) throw new Error(\"Database initialization failed.\");\n        }\n        return this.db;\n    }\n    getPool() {\n        return this.pool;\n    }\n    async healthCheck() {\n        try {\n            if (!this.pool) return false;\n            const client = await this.pool.connect();\n            await client.query(\"SELECT 1\");\n            client.release();\n            return true;\n        } catch  {\n            return false;\n        }\n    }\n    async forceReconnect() {\n        console.log(\"Forcing database reconnection...\");\n        this.reconnectAttempts = 0;\n        await this.closeConnection();\n        await this.initializeConnection();\n    }\n}\n// Singleton instance\nconst databaseManager = DatabaseManager.getInstance();\n// Compatibility exports\nconst getDb = async ()=>databaseManager.getDatabase();\nconst getPool = ()=>databaseManager.getPool();\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FBRyxDQUFDO1FBQ1osSUFBSSxDQUFDUSxpQkFBaUIsR0FBRztRQUN6QixNQUFNLElBQUksQ0FBQ3FCLGVBQWU7UUFDMUIsTUFBTSxJQUFJLENBQUNoQixvQkFBb0I7SUFDakM7QUFDRjtBQUVBLHFCQUFxQjtBQUNkLE1BQU1zQixrQkFBa0I5QixnQkFBZ0JNLFdBQVcsR0FBRztBQUU3RCx3QkFBd0I7QUFDakIsTUFBTXlCLFFBQVEsVUFBWUQsZ0JBQWdCSixXQUFXLEdBQUc7QUFDeEQsTUFBTUMsVUFBVSxJQUFNRyxnQkFBZ0JILE9BQU8sR0FBRyIsInNvdXJjZXMiOlsid2VicGFjazovL3Jlc3QtZXhwcmVzcy8uL3NlcnZlci9kYi50cz9iZTYyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvb2wsIG5lb25Db25maWcsIFBvb2xDb25maWcgfSBmcm9tIFwiQG5lb25kYXRhYmFzZS9zZXJ2ZXJsZXNzXCI7XG5pbXBvcnQgeyBkcml6emxlLCB0eXBlIE5lb25EYXRhYmFzZSB9IGZyb20gXCJkcml6emxlLW9ybS9uZW9uLXNlcnZlcmxlc3NcIjtcbmltcG9ydCB3cyBmcm9tIFwid3NcIjtcbmltcG9ydCAqIGFzIHNjaGVtYSBmcm9tIFwiQHNoYXJlZC9zY2hlbWFcIjtcblxuLy8gTmVvbiBjb25maWd1cmF0aW9uIGZvciBzZXJ2ZXJsZXNzIFBvc3RncmVzXG5uZW9uQ29uZmlnLndlYlNvY2tldENvbnN0cnVjdG9yID0gd3M7XG5uZW9uQ29uZmlnLnVzZVNlY3VyZVdlYlNvY2tldCA9IHRydWU7XG5uZW9uQ29uZmlnLnBpcGVsaW5lQ29ubmVjdCA9IGZhbHNlO1xubmVvbkNvbmZpZy5mZXRjaENvbm5lY3Rpb25DYWNoZSA9IHRydWU7XG5cbmlmICghcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMKSB7XG4gIHRocm93IG5ldyBFcnJvcihcbiAgICBcIkRBVEFCQVNFX1VSTCBtdXN0IGJlIHNldC4gRGlkIHlvdSBmb3JnZXQgdG8gcHJvdmlzaW9uIGEgZGF0YWJhc2U/XCIsXG4gICk7XG59XG5cbi8vIENvbm5lY3Rpb24gcG9vbCBjb25maWd1cmF0aW9uXG5jb25zdCBwb29sQ29uZmlnOiBQb29sQ29uZmlnID0ge1xuICBjb25uZWN0aW9uU3RyaW5nOiBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkwsXG4gIG1heDogMTAsXG4gIG1pbjogMixcbiAgaWRsZVRpbWVvdXRNaWxsaXM6IDMwXzAwMCxcbiAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IDEwXzAwMCxcbiAgbWF4VXNlczogN181MDAsXG4gIGtlZXBBbGl2ZTogdHJ1ZSxcbiAgbG9nOiAobXNnLCBsZXZlbCkgPT4ge1xuICAgIGlmIChsZXZlbCA9PT0gXCJlcnJvclwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRGF0YWJhc2UgcG9vbCBlcnJvcjpcIiwgbXNnKTtcbiAgICB9IGVsc2UgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiRGF0YWJhc2UgcG9vbDpcIiwgbGV2ZWwsIG1zZyk7XG4gICAgfVxuICB9LFxufTtcblxuY2xhc3MgRGF0YWJhc2VNYW5hZ2VyIHtcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IERhdGFiYXNlTWFuYWdlcjtcbiAgcHJpdmF0ZSBwb29sOiBQb29sIHwgbnVsbCA9IG51bGw7XG4gIHByaXZhdGUgZGI6IE5lb25EYXRhYmFzZTx0eXBlb2Ygc2NoZW1hPiB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIHJlY29ubmVjdEF0dGVtcHRzID0gMDtcbiAgcHJpdmF0ZSByZWFkb25seSBtYXhSZWNvbm5lY3RBdHRlbXB0cyA9IDU7XG4gIHByaXZhdGUgaXNSZWNvbm5lY3RpbmcgPSBmYWxzZTtcblxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cblxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogRGF0YWJhc2VNYW5hZ2VyIHtcbiAgICBpZiAoIURhdGFiYXNlTWFuYWdlci5pbnN0YW5jZSkge1xuICAgICAgRGF0YWJhc2VNYW5hZ2VyLmluc3RhbmNlID0gbmV3IERhdGFiYXNlTWFuYWdlcigpO1xuICAgICAgRGF0YWJhc2VNYW5hZ2VyLmluc3RhbmNlLmluaXRpYWxpemVDb25uZWN0aW9uKCkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIGluaXRpYWxpemUgZGF0YWJhc2U6XCIsIGVycik7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIERhdGFiYXNlTWFuYWdlci5pbnN0YW5jZTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgaW5pdGlhbGl6ZUNvbm5lY3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKFwiSW5pdGlhbGl6aW5nIGRhdGFiYXNlIGNvbm5lY3Rpb24uLi5cIik7XG4gICAgICB0aGlzLnBvb2wgPSBuZXcgUG9vbChwb29sQ29uZmlnKTtcblxuICAgICAgLy8gVGVzdCB0aGUgY29ubmVjdGlvblxuICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgdGhpcy5wb29sLmNvbm5lY3QoKTtcbiAgICAgIGF3YWl0IGNsaWVudC5xdWVyeShcIlNFTEVDVCAxXCIpO1xuICAgICAgY2xpZW50LnJlbGVhc2UoKTtcblxuICAgICAgdGhpcy5kYiA9IGRyaXp6bGUodGhpcy5wb29sLCB7IHNjaGVtYSB9KTtcbiAgICAgIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgPSAwO1xuICAgICAgdGhpcy5zZXR1cENvbm5lY3Rpb25Nb25pdG9yaW5nKCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFwiRGF0YWJhc2UgY29ubmVjdGlvbiBlc3RhYmxpc2hlZC5cIik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gaW5pdGlhbGl6ZSBkYXRhYmFzZSBjb25uZWN0aW9uOlwiLCBlcnJvcik7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUNvbm5lY3Rpb25FcnJvcihlcnJvcik7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzZXR1cENvbm5lY3Rpb25Nb25pdG9yaW5nKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5wb29sKSByZXR1cm47XG4gICAgdGhpcy5wb29sLm9uKFwiZXJyb3JcIiwgYXN5bmMgKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkRhdGFiYXNlIHBvb2wgZXJyb3I6XCIsIGVycik7XG4gICAgICBhd2FpdCB0aGlzLmhhbmRsZUNvbm5lY3Rpb25FcnJvcihlcnIpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBoYW5kbGVDb25uZWN0aW9uRXJyb3IoZXJyb3I6IHVua25vd24pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5pc1JlY29ubmVjdGluZykgcmV0dXJuO1xuXG4gICAgY29uc29sZS5lcnJvcihcIkRhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3I6XCIsIGVycm9yKTtcbiAgICBpZiAodGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA8IHRoaXMubWF4UmVjb25uZWN0QXR0ZW1wdHMpIHtcbiAgICAgIHRoaXMuaXNSZWNvbm5lY3RpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cysrO1xuXG4gICAgICBjb25zdCBiYWNrb2ZmTXMgPSBNYXRoLm1pbihcbiAgICAgICAgMTAwMCAqIE1hdGgucG93KDIsIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgLSAxKSxcbiAgICAgICAgMzBfMDAwLFxuICAgICAgKTtcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGJhY2tvZmZNcykpO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmNsb3NlQ29ubmVjdGlvbigpO1xuICAgICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDb25uZWN0aW9uKCk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICB0aGlzLmlzUmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJNYXggcmVjb25uZWN0aW9uIGF0dGVtcHRzIHJlYWNoZWQuXCIpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNsb3NlQ29ubmVjdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBpZiAodGhpcy5wb29sKSB7XG4gICAgICBhd2FpdCB0aGlzLnBvb2wuZW5kKCk7XG4gICAgICB0aGlzLnBvb2wgPSBudWxsO1xuICAgICAgdGhpcy5kYiA9IG51bGw7XG4gICAgICBjb25zb2xlLmxvZyhcIkRhdGFiYXNlIGNvbm5lY3Rpb24gY2xvc2VkXCIpO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdldERhdGFiYXNlKCk6IFByb21pc2U8TmVvbkRhdGFiYXNlPHR5cGVvZiBzY2hlbWE+PiB7XG4gICAgaWYgKCF0aGlzLmRiKSB7XG4gICAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDb25uZWN0aW9uKCk7XG4gICAgICBpZiAoIXRoaXMuZGIpIHRocm93IG5ldyBFcnJvcihcIkRhdGFiYXNlIGluaXRpYWxpemF0aW9uIGZhaWxlZC5cIik7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmRiO1xuICB9XG5cbiAgZ2V0UG9vbCgpOiBQb29sIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMucG9vbDtcbiAgfVxuXG4gIGFzeW5jIGhlYWx0aENoZWNrKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIXRoaXMucG9vbCkgcmV0dXJuIGZhbHNlO1xuICAgICAgY29uc3QgY2xpZW50ID0gYXdhaXQgdGhpcy5wb29sLmNvbm5lY3QoKTtcbiAgICAgIGF3YWl0IGNsaWVudC5xdWVyeShcIlNFTEVDVCAxXCIpO1xuICAgICAgY2xpZW50LnJlbGVhc2UoKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGZvcmNlUmVjb25uZWN0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnNvbGUubG9nKFwiRm9yY2luZyBkYXRhYmFzZSByZWNvbm5lY3Rpb24uLi5cIik7XG4gICAgdGhpcy5yZWNvbm5lY3RBdHRlbXB0cyA9IDA7XG4gICAgYXdhaXQgdGhpcy5jbG9zZUNvbm5lY3Rpb24oKTtcbiAgICBhd2FpdCB0aGlzLmluaXRpYWxpemVDb25uZWN0aW9uKCk7XG4gIH1cbn1cblxuLy8gU2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgZGF0YWJhc2VNYW5hZ2VyID0gRGF0YWJhc2VNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG5cbi8vIENvbXBhdGliaWxpdHkgZXhwb3J0c1xuZXhwb3J0IGNvbnN0IGdldERiID0gYXN5bmMgKCkgPT4gZGF0YWJhc2VNYW5hZ2VyLmdldERhdGFiYXNlKCk7XG5leHBvcnQgY29uc3QgZ2V0UG9vbCA9ICgpID0+IGRhdGFiYXNlTWFuYWdlci5nZXRQb29sKCk7XG4iXSwibmFtZXMiOlsiUG9vbCIsIm5lb25Db25maWciLCJkcml6emxlIiwid3MiLCJzY2hlbWEiLCJ3ZWJTb2NrZXRDb25zdHJ1Y3RvciIsInVzZVNlY3VyZVdlYlNvY2tldCIsInBpcGVsaW5lQ29ubmVjdCIsImZldGNoQ29ubmVjdGlvbkNhY2hlIiwicHJvY2VzcyIsImVudiIsIkRBVEFCQVNFX1VSTCIsIkVycm9yIiwicG9vbENvbmZpZyIsImNvbm5lY3Rpb25TdHJpbmciLCJtYXgiLCJtaW4iLCJpZGxlVGltZW91dE1pbGxpcyIsImNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzIiwibWF4VXNlcyIsImtlZXBBbGl2ZSIsImxvZyIsIm1zZyIsImxldmVsIiwiY29uc29sZSIsImVycm9yIiwiRGF0YWJhc2VNYW5hZ2VyIiwicG9vbCIsImRiIiwicmVjb25uZWN0QXR0ZW1wdHMiLCJtYXhSZWNvbm5lY3RBdHRlbXB0cyIsImlzUmVjb25uZWN0aW5nIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImluaXRpYWxpemVDb25uZWN0aW9uIiwiY2F0Y2giLCJlcnIiLCJjbGllbnQiLCJjb25uZWN0IiwicXVlcnkiLCJyZWxlYXNlIiwic2V0dXBDb25uZWN0aW9uTW9uaXRvcmluZyIsImhhbmRsZUNvbm5lY3Rpb25FcnJvciIsIm9uIiwiYmFja29mZk1zIiwiTWF0aCIsInBvdyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImNsb3NlQ29ubmVjdGlvbiIsImVuZCIsImdldERhdGFiYXNlIiwiZ2V0UG9vbCIsImhlYWx0aENoZWNrIiwiZm9yY2VSZWNvbm5lY3QiLCJkYXRhYmFzZU1hbmFnZXIiLCJnZXREYiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./server/db.ts\n");

/***/ }),

/***/ "(api)/./server/storage.ts":
/*!***************************!*\
  !*** ./server/storage.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DatabaseStorage: () => (/* binding */ DatabaseStorage),\n/* harmony export */   getDbCompat: () => (/* binding */ getDbCompat),\n/* harmony export */   storage: () => (/* binding */ storage)\n/* harmony export */ });\n/* harmony import */ var _shared_schema__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @shared/schema */ \"(api)/./shared/schema.ts\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db */ \"(api)/./server/db.ts\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm */ \"drizzle-orm\");\n/* harmony import */ var _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./db-retry-handler */ \"(api)/./server/db-retry-handler.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_shared_schema__WEBPACK_IMPORTED_MODULE_0__, _db__WEBPACK_IMPORTED_MODULE_1__, drizzle_orm__WEBPACK_IMPORTED_MODULE_2__, _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__]);\n([_shared_schema__WEBPACK_IMPORTED_MODULE_0__, _db__WEBPACK_IMPORTED_MODULE_1__, drizzle_orm__WEBPACK_IMPORTED_MODULE_2__, _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n //  import both\n\n\nclass DatabaseStorage {\n    async getUser(id) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [user] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.id, id));\n            return user || undefined;\n        });\n    }\n    async getUserByUsername(username) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [user] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users.username, username));\n            return user || undefined;\n        });\n    }\n    async createUser(insertUser) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [user] = await db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.users).values(insertUser).returning();\n            return user;\n        });\n    }\n    async addToWaitlist(insertEmail) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            try {\n                const [waitlistEmail] = await db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails).values(insertEmail).returning();\n                return waitlistEmail;\n            } catch (error) {\n                if (error.code === \"23505\") {\n                    throw new Error(\"Email already registered for waitlist\");\n                }\n                throw error;\n            }\n        });\n    }\n    async getWaitlistEmails() {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            return db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails);\n        });\n    }\n    async isEmailInWaitlist(email) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [result] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.waitlistEmails.email, email));\n            return !!result;\n        });\n    }\n    async getUserSubjects(userId) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            return db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.desc)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.dateAdded));\n        });\n    }\n    async addUserSubject(userSubject) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [subject] = await db.insert(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).values(userSubject).returning();\n            return subject;\n        });\n    }\n    async removeUserSubject(userId, subjectId) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            await db.delete(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.subjectId, subjectId)));\n        });\n    }\n    async hasUserSubject(userId, subjectId) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [result] = await db.select().from(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.subjectId, subjectId)));\n            return !!result;\n        });\n    }\n    async updateSubjectMasteryLevel(userId, subjectId, masteryLevel) {\n        return _db_retry_handler__WEBPACK_IMPORTED_MODULE_3__.DatabaseRetryHandler.withRetry(async ()=>{\n            const db = await (0,_db__WEBPACK_IMPORTED_MODULE_1__.getDb)();\n            const [updatedSubject] = await db.update(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects).set({\n                masteryLevel\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.userId, userId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_2__.eq)(_shared_schema__WEBPACK_IMPORTED_MODULE_0__.userSubjects.subjectId, subjectId))).returning();\n            return updatedSubject || null;\n        });\n    }\n}\nconst storage = new DatabaseStorage();\n//  Compatibility export for legacy usage\nconst getDbCompat = async ()=>{\n    return _db__WEBPACK_IMPORTED_MODULE_1__.databaseManager.getDatabase();\n};\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUM7WUFDcEMsTUFBTUMsS0FBSyxNQUFNViwwQ0FBS0E7WUFDdEIsTUFBTSxDQUFDOEMsZUFBZSxHQUFHLE1BQU1wQyxHQUM1QnFDLE1BQU0sQ0FBQ2hELHdEQUFZQSxFQUNuQmlELEdBQUcsQ0FBQztnQkFBRUg7WUFBYSxHQUNuQi9CLEtBQUssQ0FDSlgsZ0RBQUdBLENBQ0RELCtDQUFFQSxDQUFDSCx3REFBWUEsQ0FBQ21DLE1BQU0sRUFBRUEsU0FDeEJoQywrQ0FBRUEsQ0FBQ0gsd0RBQVlBLENBQUMwQyxTQUFTLEVBQUVBLGFBRzlCbkIsU0FBUztZQUNaLE9BQU93QixrQkFBa0I7UUFDM0I7SUFDRjtBQUNGO0FBRU8sTUFBTUcsVUFBVSxJQUFJM0Msa0JBQWtCO0FBRTdDLDBDQUEwQztBQUNuQyxNQUFNNEMsY0FBYztJQUN6QixPQUFPakQsZ0RBQWVBLENBQUNrRCxXQUFXO0FBQ3BDLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZXN0LWV4cHJlc3MvLi9zZXJ2ZXIvc3RvcmFnZS50cz9jYzQ4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIHVzZXJzLFxuICB3YWl0bGlzdEVtYWlscyxcbiAgdXNlclN1YmplY3RzLFxuICB0eXBlIFVzZXIsXG4gIHR5cGUgSW5zZXJ0VXNlcixcbiAgdHlwZSBXYWl0bGlzdEVtYWlsLFxuICB0eXBlIEluc2VydFdhaXRsaXN0RW1haWwsXG4gIHR5cGUgVXNlclN1YmplY3QsXG4gIHR5cGUgSW5zZXJ0VXNlclN1YmplY3QsXG59IGZyb20gXCJAc2hhcmVkL3NjaGVtYVwiO1xuaW1wb3J0IHsgZ2V0RGIsIGRhdGFiYXNlTWFuYWdlciB9IGZyb20gXCIuL2RiXCI7IC8vIOKchSBpbXBvcnQgYm90aFxuaW1wb3J0IHsgZXEsIGFuZCwgZGVzYyB9IGZyb20gXCJkcml6emxlLW9ybVwiO1xuaW1wb3J0IHsgRGF0YWJhc2VSZXRyeUhhbmRsZXIgfSBmcm9tIFwiLi9kYi1yZXRyeS1oYW5kbGVyXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVN0b3JhZ2Uge1xuICBnZXRVc2VyKGlkOiBudW1iZXIpOiBQcm9taXNlPFVzZXIgfCB1bmRlZmluZWQ+O1xuICBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZTogc3RyaW5nKTogUHJvbWlzZTxVc2VyIHwgdW5kZWZpbmVkPjtcbiAgY3JlYXRlVXNlcih1c2VyOiBJbnNlcnRVc2VyKTogUHJvbWlzZTxVc2VyPjtcbiAgYWRkVG9XYWl0bGlzdChlbWFpbDogSW5zZXJ0V2FpdGxpc3RFbWFpbCk6IFByb21pc2U8V2FpdGxpc3RFbWFpbD47XG4gIGdldFdhaXRsaXN0RW1haWxzKCk6IFByb21pc2U8V2FpdGxpc3RFbWFpbFtdPjtcbiAgaXNFbWFpbEluV2FpdGxpc3QoZW1haWw6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj47XG4gIGdldFVzZXJTdWJqZWN0cyh1c2VySWQ6IG51bWJlcik6IFByb21pc2U8VXNlclN1YmplY3RbXT47XG4gIGFkZFVzZXJTdWJqZWN0KHVzZXJTdWJqZWN0OiBJbnNlcnRVc2VyU3ViamVjdCk6IFByb21pc2U8VXNlclN1YmplY3Q+O1xuICByZW1vdmVVc2VyU3ViamVjdCh1c2VySWQ6IG51bWJlciwgc3ViamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+O1xuICBoYXNVc2VyU3ViamVjdCh1c2VySWQ6IG51bWJlciwgc3ViamVjdElkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+O1xuICB1cGRhdGVTdWJqZWN0TWFzdGVyeUxldmVsKFxuICAgIHVzZXJJZDogbnVtYmVyLFxuICAgIHN1YmplY3RJZDogc3RyaW5nLFxuICAgIG1hc3RlcnlMZXZlbDogbnVtYmVyLFxuICApOiBQcm9taXNlPFVzZXJTdWJqZWN0IHwgbnVsbD47XG59XG5cbmV4cG9ydCBjbGFzcyBEYXRhYmFzZVN0b3JhZ2UgaW1wbGVtZW50cyBJU3RvcmFnZSB7XG4gIGFzeW5jIGdldFVzZXIoaWQ6IG51bWJlcik6IFByb21pc2U8VXNlciB8IHVuZGVmaW5lZD4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3VzZXJdID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh1c2Vycykud2hlcmUoZXEodXNlcnMuaWQsIGlkKSk7XG4gICAgICByZXR1cm4gdXNlciB8fCB1bmRlZmluZWQ7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRVc2VyQnlVc2VybmFtZSh1c2VybmFtZTogc3RyaW5nKTogUHJvbWlzZTxVc2VyIHwgdW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiKCk7XG4gICAgICBjb25zdCBbdXNlcl0gPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20odXNlcnMpXG4gICAgICAgIC53aGVyZShlcSh1c2Vycy51c2VybmFtZSwgdXNlcm5hbWUpKTtcbiAgICAgIHJldHVybiB1c2VyIHx8IHVuZGVmaW5lZDtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZVVzZXIoaW5zZXJ0VXNlcjogSW5zZXJ0VXNlcik6IFByb21pc2U8VXNlcj4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3VzZXJdID0gYXdhaXQgZGIuaW5zZXJ0KHVzZXJzKS52YWx1ZXMoaW5zZXJ0VXNlcikucmV0dXJuaW5nKCk7XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGFkZFRvV2FpdGxpc3QoXG4gICAgaW5zZXJ0RW1haWw6IEluc2VydFdhaXRsaXN0RW1haWwsXG4gICk6IFByb21pc2U8V2FpdGxpc3RFbWFpbD4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgW3dhaXRsaXN0RW1haWxdID0gYXdhaXQgZGJcbiAgICAgICAgICAuaW5zZXJ0KHdhaXRsaXN0RW1haWxzKVxuICAgICAgICAgIC52YWx1ZXMoaW5zZXJ0RW1haWwpXG4gICAgICAgICAgLnJldHVybmluZygpO1xuICAgICAgICByZXR1cm4gd2FpdGxpc3RFbWFpbDtcbiAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IFwiMjM1MDVcIikge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkVtYWlsIGFscmVhZHkgcmVnaXN0ZXJlZCBmb3Igd2FpdGxpc3RcIik7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBnZXRXYWl0bGlzdEVtYWlscygpOiBQcm9taXNlPFdhaXRsaXN0RW1haWxbXT4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgcmV0dXJuIGRiLnNlbGVjdCgpLmZyb20od2FpdGxpc3RFbWFpbHMpO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgaXNFbWFpbEluV2FpdGxpc3QoZW1haWw6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgY29uc3QgW3Jlc3VsdF0gPSBhd2FpdCBkYlxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLmZyb20od2FpdGxpc3RFbWFpbHMpXG4gICAgICAgIC53aGVyZShlcSh3YWl0bGlzdEVtYWlscy5lbWFpbCwgZW1haWwpKTtcbiAgICAgIHJldHVybiAhIXJlc3VsdDtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGdldFVzZXJTdWJqZWN0cyh1c2VySWQ6IG51bWJlcik6IFByb21pc2U8VXNlclN1YmplY3RbXT4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgcmV0dXJuIGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VyU3ViamVjdHMpXG4gICAgICAgIC53aGVyZShlcSh1c2VyU3ViamVjdHMudXNlcklkLCB1c2VySWQpKVxuICAgICAgICAub3JkZXJCeShkZXNjKHVzZXJTdWJqZWN0cy5kYXRlQWRkZWQpKTtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGFkZFVzZXJTdWJqZWN0KHVzZXJTdWJqZWN0OiBJbnNlcnRVc2VyU3ViamVjdCk6IFByb21pc2U8VXNlclN1YmplY3Q+IHtcbiAgICByZXR1cm4gRGF0YWJhc2VSZXRyeUhhbmRsZXIud2l0aFJldHJ5KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGIoKTtcbiAgICAgIGNvbnN0IFtzdWJqZWN0XSA9IGF3YWl0IGRiXG4gICAgICAgIC5pbnNlcnQodXNlclN1YmplY3RzKVxuICAgICAgICAudmFsdWVzKHVzZXJTdWJqZWN0KVxuICAgICAgICAucmV0dXJuaW5nKCk7XG4gICAgICByZXR1cm4gc3ViamVjdDtcbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHJlbW92ZVVzZXJTdWJqZWN0KHVzZXJJZDogbnVtYmVyLCBzdWJqZWN0SWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiBEYXRhYmFzZVJldHJ5SGFuZGxlci53aXRoUmV0cnkoYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYigpO1xuICAgICAgYXdhaXQgZGJcbiAgICAgICAgLmRlbGV0ZSh1c2VyU3ViamVjdHMpXG4gICAgICAgIC53aGVyZShcbiAgICAgICAgICBhbmQoXG4gICAgICAgICAgICBlcSh1c2VyU3ViamVjdHMudXNlcklkLCB1c2VySWQpLFxuICAgICAgICAgICAgZXEodXNlclN1YmplY3RzLnN1YmplY3RJZCwgc3ViamVjdElkKSxcbiAgICAgICAgICApLFxuICAgICAgICApO1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgaGFzVXNlclN1YmplY3QodXNlcklkOiBudW1iZXIsIHN1YmplY3RJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIERhdGFiYXNlUmV0cnlIYW5kbGVyLndpdGhSZXRyeShhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiKCk7XG4gICAgICBjb25zdCBbcmVzdWx0XSA9IGF3YWl0IGRiXG4gICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAuZnJvbSh1c2VyU3ViamVjdHMpXG4gICAgICAgIC53aGVyZShcbiAgICAgICAgICBhbmQoXG4gICAgICAgICAgICBlcSh1c2VyU3ViamVjdHMudXNlcklkLCB1c2VySWQpLFxuICAgICAgICAgICAgZXEodXNlclN1YmplY3RzLnN1YmplY3RJZCwgc3ViamVjdElkKSxcbiAgICAgICAgICApLFxuICAgICAgICApO1xuICAgICAgcmV0dXJuICEhcmVzdWx0O1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgdXBkYXRlU3ViamVjdE1hc3RlcnlMZXZlbChcbiAgICB1c2VySWQ6IG51bWJlcixcbiAgICBzdWJqZWN0SWQ6IHN0cmluZyxcbiAgICBtYXN0ZXJ5TGV2ZWw6IG51bWJlcixcbiAgKTogUHJvbWlzZTxVc2VyU3ViamVjdCB8IG51bGw+IHtcbiAgICByZXR1cm4gRGF0YWJhc2VSZXRyeUhhbmRsZXIud2l0aFJldHJ5KGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGIoKTtcbiAgICAgIGNvbnN0IFt1cGRhdGVkU3ViamVjdF0gPSBhd2FpdCBkYlxuICAgICAgICAudXBkYXRlKHVzZXJTdWJqZWN0cylcbiAgICAgICAgLnNldCh7IG1hc3RlcnlMZXZlbCB9KVxuICAgICAgICAud2hlcmUoXG4gICAgICAgICAgYW5kKFxuICAgICAgICAgICAgZXEodXNlclN1YmplY3RzLnVzZXJJZCwgdXNlcklkKSxcbiAgICAgICAgICAgIGVxKHVzZXJTdWJqZWN0cy5zdWJqZWN0SWQsIHN1YmplY3RJZCksXG4gICAgICAgICAgKSxcbiAgICAgICAgKVxuICAgICAgICAucmV0dXJuaW5nKCk7XG4gICAgICByZXR1cm4gdXBkYXRlZFN1YmplY3QgfHwgbnVsbDtcbiAgICB9KTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3Qgc3RvcmFnZSA9IG5ldyBEYXRhYmFzZVN0b3JhZ2UoKTtcblxuLy8g4pyFIENvbXBhdGliaWxpdHkgZXhwb3J0IGZvciBsZWdhY3kgdXNhZ2VcbmV4cG9ydCBjb25zdCBnZXREYkNvbXBhdCA9IGFzeW5jICgpID0+IHtcbiAgcmV0dXJuIGRhdGFiYXNlTWFuYWdlci5nZXREYXRhYmFzZSgpO1xufTtcbiJdLCJuYW1lcyI6WyJ1c2VycyIsIndhaXRsaXN0RW1haWxzIiwidXNlclN1YmplY3RzIiwiZ2V0RGIiLCJkYXRhYmFzZU1hbmFnZXIiLCJlcSIsImFuZCIsImRlc2MiLCJEYXRhYmFzZVJldHJ5SGFuZGxlciIsIkRhdGFiYXNlU3RvcmFnZSIsImdldFVzZXIiLCJpZCIsIndpdGhSZXRyeSIsImRiIiwidXNlciIsInNlbGVjdCIsImZyb20iLCJ3aGVyZSIsInVuZGVmaW5lZCIsImdldFVzZXJCeVVzZXJuYW1lIiwidXNlcm5hbWUiLCJjcmVhdGVVc2VyIiwiaW5zZXJ0VXNlciIsImluc2VydCIsInZhbHVlcyIsInJldHVybmluZyIsImFkZFRvV2FpdGxpc3QiLCJpbnNlcnRFbWFpbCIsIndhaXRsaXN0RW1haWwiLCJlcnJvciIsImNvZGUiLCJFcnJvciIsImdldFdhaXRsaXN0RW1haWxzIiwiaXNFbWFpbEluV2FpdGxpc3QiLCJlbWFpbCIsInJlc3VsdCIsImdldFVzZXJTdWJqZWN0cyIsInVzZXJJZCIsIm9yZGVyQnkiLCJkYXRlQWRkZWQiLCJhZGRVc2VyU3ViamVjdCIsInVzZXJTdWJqZWN0Iiwic3ViamVjdCIsInJlbW92ZVVzZXJTdWJqZWN0Iiwic3ViamVjdElkIiwiZGVsZXRlIiwiaGFzVXNlclN1YmplY3QiLCJ1cGRhdGVTdWJqZWN0TWFzdGVyeUxldmVsIiwibWFzdGVyeUxldmVsIiwidXBkYXRlZFN1YmplY3QiLCJ1cGRhdGUiLCJzZXQiLCJzdG9yYWdlIiwiZ2V0RGJDb21wYXQiLCJnZXREYXRhYmFzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./server/storage.ts\n");

/***/ }),

/***/ "(api)/./shared/schema.ts":
/*!**************************!*\
  !*** ./shared/schema.ts ***!
  \**************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   insertUserSchema: () => (/* binding */ insertUserSchema),\n/* harmony export */   insertUserSubjectSchema: () => (/* binding */ insertUserSubjectSchema),\n/* harmony export */   insertWaitlistEmailSchema: () => (/* binding */ insertWaitlistEmailSchema),\n/* harmony export */   userSubjects: () => (/* binding */ userSubjects),\n/* harmony export */   users: () => (/* binding */ users),\n/* harmony export */   waitlistEmails: () => (/* binding */ waitlistEmails)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"drizzle-orm/pg-core\");\n/* harmony import */ var drizzle_zod__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-zod */ \"drizzle-zod\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__, drizzle_zod__WEBPACK_IMPORTED_MODULE_1__]);\n([drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__, drizzle_zod__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\nconst users = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"users\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.serial)(\"id\").primaryKey(),\n    username: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"username\").notNull().unique(),\n    password: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"password\").notNull()\n});\nconst waitlistEmails = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"waitlist_emails\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.serial)(\"id\").primaryKey(),\n    email: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"email\").notNull().unique(),\n    signedUpAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.timestamp)(\"signed_up_at\").defaultNow().notNull()\n});\nconst userSubjects = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"user_subjects\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.serial)(\"id\").primaryKey(),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"user_id\").notNull().references(()=>users.id),\n    subjectId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"subject_id\").notNull(),\n    name: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"name\").notNull(),\n    description: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"description\").notNull(),\n    units: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"units\").notNull(),\n    difficulty: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"difficulty\").notNull(),\n    examDate: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.text)(\"exam_date\").notNull(),\n    progress: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"progress\").default(0).notNull(),\n    masteryLevel: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.integer)(\"mastery_level\").default(4).notNull(),\n    lastStudied: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.timestamp)(\"last_studied\"),\n    dateAdded: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.timestamp)(\"date_added\").defaultNow().notNull()\n});\nconst insertUserSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_1__.createInsertSchema)(users).pick({\n    username: true,\n    password: true\n});\nconst insertWaitlistEmailSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_1__.createInsertSchema)(waitlistEmails).pick({\n    email: true\n});\nconst insertUserSubjectSchema = (0,drizzle_zod__WEBPACK_IMPORTED_MODULE_1__.createInsertSchema)(userSubjects).omit({\n    id: true,\n    dateAdded: true\n});\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zaGFyZWQvc2NoZW1hLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXlGO0FBQ3hDO0FBRzFDLE1BQU1NLFFBQVFOLDREQUFPQSxDQUFDLFNBQVM7SUFDcENPLElBQUlMLDJEQUFNQSxDQUFDLE1BQU1NLFVBQVU7SUFDM0JDLFVBQVVSLHlEQUFJQSxDQUFDLFlBQVlTLE9BQU8sR0FBR0MsTUFBTTtJQUMzQ0MsVUFBVVgseURBQUlBLENBQUMsWUFBWVMsT0FBTztBQUNwQyxHQUFHO0FBRUksTUFBTUcsaUJBQWlCYiw0REFBT0EsQ0FBQyxtQkFBbUI7SUFDdkRPLElBQUlMLDJEQUFNQSxDQUFDLE1BQU1NLFVBQVU7SUFDM0JNLE9BQU9iLHlEQUFJQSxDQUFDLFNBQVNTLE9BQU8sR0FBR0MsTUFBTTtJQUNyQ0ksWUFBWVgsOERBQVNBLENBQUMsZ0JBQWdCWSxVQUFVLEdBQUdOLE9BQU87QUFDNUQsR0FBRztBQUVJLE1BQU1PLGVBQWVqQiw0REFBT0EsQ0FBQyxpQkFBaUI7SUFDbkRPLElBQUlMLDJEQUFNQSxDQUFDLE1BQU1NLFVBQVU7SUFDM0JVLFFBQVFmLDREQUFPQSxDQUFDLFdBQVdPLE9BQU8sR0FBR1MsVUFBVSxDQUFDLElBQU1iLE1BQU1DLEVBQUU7SUFDOURhLFdBQVduQix5REFBSUEsQ0FBQyxjQUFjUyxPQUFPO0lBQ3JDVyxNQUFNcEIseURBQUlBLENBQUMsUUFBUVMsT0FBTztJQUMxQlksYUFBYXJCLHlEQUFJQSxDQUFDLGVBQWVTLE9BQU87SUFDeENhLE9BQU9wQiw0REFBT0EsQ0FBQyxTQUFTTyxPQUFPO0lBQy9CYyxZQUFZdkIseURBQUlBLENBQUMsY0FBY1MsT0FBTztJQUN0Q2UsVUFBVXhCLHlEQUFJQSxDQUFDLGFBQWFTLE9BQU87SUFDbkNnQixVQUFVdkIsNERBQU9BLENBQUMsWUFBWXdCLE9BQU8sQ0FBQyxHQUFHakIsT0FBTztJQUNoRGtCLGNBQWN6Qiw0REFBT0EsQ0FBQyxpQkFBaUJ3QixPQUFPLENBQUMsR0FBR2pCLE9BQU87SUFDekRtQixhQUFhekIsOERBQVNBLENBQUM7SUFDdkIwQixXQUFXMUIsOERBQVNBLENBQUMsY0FBY1ksVUFBVSxHQUFHTixPQUFPO0FBQ3pELEdBQUc7QUFFSSxNQUFNcUIsbUJBQW1CMUIsK0RBQWtCQSxDQUFDQyxPQUFPMEIsSUFBSSxDQUFDO0lBQzdEdkIsVUFBVTtJQUNWRyxVQUFVO0FBQ1osR0FBRztBQUVJLE1BQU1xQiw0QkFBNEI1QiwrREFBa0JBLENBQUNRLGdCQUFnQm1CLElBQUksQ0FBQztJQUMvRWxCLE9BQU87QUFDVCxHQUFHO0FBRUksTUFBTW9CLDBCQUEwQjdCLCtEQUFrQkEsQ0FBQ1ksY0FBY2tCLElBQUksQ0FBQztJQUMzRTVCLElBQUk7SUFDSnVCLFdBQVc7QUFDYixHQUFHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVzdC1leHByZXNzLy4vc2hhcmVkL3NjaGVtYS50cz8xYjQwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHBnVGFibGUsIHRleHQsIHNlcmlhbCwgaW50ZWdlciwgYm9vbGVhbiwgdGltZXN0YW1wIH0gZnJvbSBcImRyaXp6bGUtb3JtL3BnLWNvcmVcIjtcbmltcG9ydCB7IGNyZWF0ZUluc2VydFNjaGVtYSB9IGZyb20gXCJkcml6emxlLXpvZFwiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcblxuZXhwb3J0IGNvbnN0IHVzZXJzID0gcGdUYWJsZShcInVzZXJzXCIsIHtcbiAgaWQ6IHNlcmlhbChcImlkXCIpLnByaW1hcnlLZXkoKSxcbiAgdXNlcm5hbWU6IHRleHQoXCJ1c2VybmFtZVwiKS5ub3ROdWxsKCkudW5pcXVlKCksXG4gIHBhc3N3b3JkOiB0ZXh0KFwicGFzc3dvcmRcIikubm90TnVsbCgpLFxufSk7XG5cbmV4cG9ydCBjb25zdCB3YWl0bGlzdEVtYWlscyA9IHBnVGFibGUoXCJ3YWl0bGlzdF9lbWFpbHNcIiwge1xuICBpZDogc2VyaWFsKFwiaWRcIikucHJpbWFyeUtleSgpLFxuICBlbWFpbDogdGV4dChcImVtYWlsXCIpLm5vdE51bGwoKS51bmlxdWUoKSxcbiAgc2lnbmVkVXBBdDogdGltZXN0YW1wKFwic2lnbmVkX3VwX2F0XCIpLmRlZmF1bHROb3coKS5ub3ROdWxsKCksXG59KTtcblxuZXhwb3J0IGNvbnN0IHVzZXJTdWJqZWN0cyA9IHBnVGFibGUoXCJ1c2VyX3N1YmplY3RzXCIsIHtcbiAgaWQ6IHNlcmlhbChcImlkXCIpLnByaW1hcnlLZXkoKSxcbiAgdXNlcklkOiBpbnRlZ2VyKFwidXNlcl9pZFwiKS5ub3ROdWxsKCkucmVmZXJlbmNlcygoKSA9PiB1c2Vycy5pZCksXG4gIHN1YmplY3RJZDogdGV4dChcInN1YmplY3RfaWRcIikubm90TnVsbCgpLFxuICBuYW1lOiB0ZXh0KFwibmFtZVwiKS5ub3ROdWxsKCksXG4gIGRlc2NyaXB0aW9uOiB0ZXh0KFwiZGVzY3JpcHRpb25cIikubm90TnVsbCgpLFxuICB1bml0czogaW50ZWdlcihcInVuaXRzXCIpLm5vdE51bGwoKSxcbiAgZGlmZmljdWx0eTogdGV4dChcImRpZmZpY3VsdHlcIikubm90TnVsbCgpLFxuICBleGFtRGF0ZTogdGV4dChcImV4YW1fZGF0ZVwiKS5ub3ROdWxsKCksXG4gIHByb2dyZXNzOiBpbnRlZ2VyKFwicHJvZ3Jlc3NcIikuZGVmYXVsdCgwKS5ub3ROdWxsKCksXG4gIG1hc3RlcnlMZXZlbDogaW50ZWdlcihcIm1hc3RlcnlfbGV2ZWxcIikuZGVmYXVsdCg0KS5ub3ROdWxsKCksIC8vIEFQIHRlc3QgZ29hbDogMywgNCwgb3IgNVxuICBsYXN0U3R1ZGllZDogdGltZXN0YW1wKFwibGFzdF9zdHVkaWVkXCIpLFxuICBkYXRlQWRkZWQ6IHRpbWVzdGFtcChcImRhdGVfYWRkZWRcIikuZGVmYXVsdE5vdygpLm5vdE51bGwoKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0VXNlclNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYSh1c2VycykucGljayh7XG4gIHVzZXJuYW1lOiB0cnVlLFxuICBwYXNzd29yZDogdHJ1ZSxcbn0pO1xuXG5leHBvcnQgY29uc3QgaW5zZXJ0V2FpdGxpc3RFbWFpbFNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYSh3YWl0bGlzdEVtYWlscykucGljayh7XG4gIGVtYWlsOiB0cnVlLFxufSk7XG5cbmV4cG9ydCBjb25zdCBpbnNlcnRVc2VyU3ViamVjdFNjaGVtYSA9IGNyZWF0ZUluc2VydFNjaGVtYSh1c2VyU3ViamVjdHMpLm9taXQoe1xuICBpZDogdHJ1ZSxcbiAgZGF0ZUFkZGVkOiB0cnVlLFxufSk7XG5cbmV4cG9ydCB0eXBlIEluc2VydFVzZXIgPSB6LmluZmVyPHR5cGVvZiBpbnNlcnRVc2VyU2NoZW1hPjtcbmV4cG9ydCB0eXBlIFVzZXIgPSB0eXBlb2YgdXNlcnMuJGluZmVyU2VsZWN0O1xuZXhwb3J0IHR5cGUgSW5zZXJ0V2FpdGxpc3RFbWFpbCA9IHouaW5mZXI8dHlwZW9mIGluc2VydFdhaXRsaXN0RW1haWxTY2hlbWE+O1xuZXhwb3J0IHR5cGUgV2FpdGxpc3RFbWFpbCA9IHR5cGVvZiB3YWl0bGlzdEVtYWlscy4kaW5mZXJTZWxlY3Q7XG5leHBvcnQgdHlwZSBJbnNlcnRVc2VyU3ViamVjdCA9IHouaW5mZXI8dHlwZW9mIGluc2VydFVzZXJTdWJqZWN0U2NoZW1hPjtcbmV4cG9ydCB0eXBlIFVzZXJTdWJqZWN0ID0gdHlwZW9mIHVzZXJTdWJqZWN0cy4kaW5mZXJTZWxlY3Q7XG4iXSwibmFtZXMiOlsicGdUYWJsZSIsInRleHQiLCJzZXJpYWwiLCJpbnRlZ2VyIiwidGltZXN0YW1wIiwiY3JlYXRlSW5zZXJ0U2NoZW1hIiwidXNlcnMiLCJpZCIsInByaW1hcnlLZXkiLCJ1c2VybmFtZSIsIm5vdE51bGwiLCJ1bmlxdWUiLCJwYXNzd29yZCIsIndhaXRsaXN0RW1haWxzIiwiZW1haWwiLCJzaWduZWRVcEF0IiwiZGVmYXVsdE5vdyIsInVzZXJTdWJqZWN0cyIsInVzZXJJZCIsInJlZmVyZW5jZXMiLCJzdWJqZWN0SWQiLCJuYW1lIiwiZGVzY3JpcHRpb24iLCJ1bml0cyIsImRpZmZpY3VsdHkiLCJleGFtRGF0ZSIsInByb2dyZXNzIiwiZGVmYXVsdCIsIm1hc3RlcnlMZXZlbCIsImxhc3RTdHVkaWVkIiwiZGF0ZUFkZGVkIiwiaW5zZXJ0VXNlclNjaGVtYSIsInBpY2siLCJpbnNlcnRXYWl0bGlzdEVtYWlsU2NoZW1hIiwiaW5zZXJ0VXNlclN1YmplY3RTY2hlbWEiLCJvbWl0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./shared/schema.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fuser%2Fsubjects&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fuser%2Fsubjects.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();